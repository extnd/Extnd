Ext.define("Extnd.Database",{constructor:function(a){var b=this;Ext.apply(b,a);Ext.Ajax.request({method:"GET",disableCaching:true,success:b.onGetDatabaseSuccess,failure:b.onGetDatabaseFailure,scope:b,options:a,url:Ext.nd.extndUrl+"Database?OpenAgent&db="+b.dbPath})},onGetDatabaseSuccess:function(a,c){var d=Ext.decode(a.responseText),b=c.options;Ext.apply(this,d);Ext.callback(b.success,b.scope,[this])},onGetDatabaseFailure:function(a){console.log("failed")}});Ext.define("Extnd",{singleton:true,alternateClassName:["Ext.nd"],session:{},version:"2.0.0",versionDetails:{major:2,minor:0,patch:0},extjsVersion:"4.1.3",ACCESS_LEVELS:{0:"No Access",1:"Depositor",2:"Reader",3:"Author",4:"Editor",5:"Designer",6:"Manager"},dateTimeFormats:{dateFormat:"m/d/Y",timeFormat:"h:i:s A",dateTimeFormat:"m/d/Y h:i:s A",show:"date"},getBlankImageUrl:function(){return this.extndUrl+"resources/images/s.gif"},init:function(a){Ext.apply(this,a);Ext.BLANK_IMAGE_URL=this.getBlankImageUrl()}});Ext.override(Ext.ClassManager,{addNameAlternateMappings:function(d){var a=this.maps.alternateToName,g=this.maps.nameToAlternates,c,e,f,b;for(c in d){e=g[c]||(g[c]=[]);for(b=0;b<d[c].length;b++){f=d[c][b];if(!a[f]){a[f]=c;e.push(f)}}}return this}});Ext.define("Extnd.Session",{constructor:function(a){var b=this;Ext.apply(b,a);Ext.Ajax.request({method:"GET",disableCaching:true,success:b.onGetSessionSuccess,failure:b.onGetSessionFailure,scope:b,options:a,url:b.extndUrl+"Session.json?OpenAgent&db="+b.dbPath||""})},onGetSessionSuccess:function(a,d){var c=Ext.decode(a.responseText),b=d.options;Ext.apply(this,c);Ext.callback(b.success,b.scope,[this,a,d])},onGetSessionFailure:function(a){console.log("failed")},evaluate:function(b,a){console.log("TODO implement evaluate code")},getDatabase:function(c,a,b){console.log("TODO implement getDatabase code")},getDbDirectory:function(a){console.log("TODO implement getDbDirectory")},getDirectory:function(a){console.log("TODO implement getDirectory")}});Ext.define("Extnd.data.ViewXmlReader",{extend:Ext.data.reader.Xml,alias:"reader.xnd-viewxml",alternateClassName:["Ext.nd.data.ViewXmlReader"],extractData:function(j){var h=this,d=[],b=h.model,a,e,c,g,f;j=Ext.DomQuery.select(h.record,j);a=j.length;if(!j.length&&Ext.isObject(j)){j=[j];a=1}for(f=0;f<a;f++){c=j[f];if(!c.isModel){g=new b(undefined,h.getId(c),c,e={});g.phantom=false;h.convertRecordData(e,c,g);h.addDominoViewEntryProps(g,c);d.push(g);if(h.implicitIncludes){h.readAssociated(g,c)}}else{d.push(c)}}return d},addDominoViewEntryProps:function(a,b){var c=this,d=Ext.DomQuery;Ext.apply(a,{position:d.selectValue("@position",b),universalId:d.selectValue("@unid",b),noteId:d.selectValue("@noteid",b),descendantCount:d.selectNumber("@descendants",b),siblingCount:d.selectNumber("@siblings",b),isCategoryTotal:!!d.selectValue("@categorytotal",b,false),isResponse:!!d.selectValue("@response",b,false)});a.columnIndentLevel=a.position.split(".").length-1;a.indentLevel=a.columnIndentLevel;a.childCount=c.getChildCount(b);a.isCategory=(a.hasChildren()&&!a.universalId)?true:false;a.unid=a.universalId},getChildCount:function(a){var c=this,b;b=a.attributes.getNamedItem("children");return b?parseFloat(b.nodeValue,0):0},getEntryDataNodeValue:function(c,g,b){var d=this,e=Ext.DomQuery,a,f;f={type:"text",data:"",category:false,indent:0};a=c.lastChild;if(a){f=d.parseEntryDataChildNodes(a);f.category=(e.selectValue("@category",c)==="true")?true:false;f.indent=(e.select("@indent",c))?e.selectNumber("@indent",c):0}b.entryData=b.entryData||{};b.entryData[g]=f;return f.data},parseEntryDataChildNodes:function(f){var e=this,d=f.nodeName,h={},g,c,b,a;if(f.childNodes&&f.childNodes.length>0&&f.childNodes[0].hasChildNodes()){g=f.childNodes;a=g.length;for(b=0;b<a;b++){c=g[b];if(c.firstChild.nodeName!=="#text"){h.type=c.firstChild.nodeName}else{h.type=d}if(b===0){h.data=c.firstChild.nodeValue}else{h.data+="\n"+c.firstChild.nodeValue}}}else{h.type=d;if(f.childNodes&&f.childNodes.length>0){h.data=f.childNodes[0].nodeValue}else{h.data=""}}return h},getNodeValue:function(e,f,b){var d=this,a=e?e.parentNode:undefined,c;if(e){if(e.nodeName==="entrydata"){c=d.getEntryDataNodeValue(e,f,b)}else{if(a&&a.nodeName==="entrydata"){c=d.getEntryDataNodeValue(a,f,b)}else{if(e.firstChild){c=e.firstChild.nodeValue}}}}return c},createFieldAccessExpression:function(d,c,b){var a=d.mapping||"entrydata[name="+d.name+"]";return'me.getNodeValue(Ext.DomQuery.selectNode("'+a+'", '+b+'), "'+d.name+'", record)'}});Ext.define("Extnd.data.proxy.Ajax",{extend:Ext.data.proxy.Ajax,alias:"proxy.xnd-ajax",alternateClassName:"Extnd.data.AjaxProxy",startParam:"start",limitParam:"count",sortParam:"",sortAscParam:"resortascending",sortDescParam:"resortdescending",constructor:function(a){var b=this;Ext.apply(b,{reader:{type:"xnd-viewxml",root:"viewentries",record:"viewentry",totalProperty:"@toplevelentries"}});b.callParent(arguments)},getParams:function(a){var b=this,f={},d=a.sorters,c,e;f=b.callParent(arguments);if(d&&d.length>0){c=b.getReader().model.prototype.fields.get(d[0].property);e=c.column;switch(d[0].direction){case"ASC":b.setDominoSortParam(f,b.sortAscParam,e);break;case"DESC":b.setDominoSortParam(f,b.sortDescParam,e);break;case"RESTORE":delete f.start;delete f.startkey;delete f[b.sortAscParam];delete f[b.sortDescParam];break}}return f},setDominoSortParam:function(d,a,c){var b=this;if(d[a]!==undefined){if(d[a]!==c){d[a]=c;if(d.start){delete d.startkey}}else{if(d.start){delete d.startkey}}}else{d[a]=c;delete d.startkey}if(a===b.sortAscParam){delete d[b.sortDescParam]}else{delete d[b.sortAscParam]}return d}});Ext.define("Extnd.data.ViewModel",{extend:Ext.data.Model,alternateClassName:["Extnd.data.ViewEntry","Ext.nd.data.ViewModel","Ext.nd.data.ViewEntry"],idProperty:"position",getPosition:function(a){return(this.position.split(".").join(a))},hasChildren:function(){return !!this.childCount}},function(){Ext.data.Types.DOMINO={convert:function(a,b){return a},sortType:function(a){return a},type:"domino"}});Ext.define("Extnd.data.ViewStore",{extend:Ext.data.Store,alternateClassName:["Ext.nd.data.ViewStore"],currentStart:"1",constructor:function(a){var b=this;a=b.cleanUpConfig(a);if(!a.viewUrl){a.viewUrl=a.dbPath+a.viewName+"?ReadViewEntries"}else{a.viewUrl=(a.viewUrl.indexOf("?")!==-1)?a.viewUrl:a.viewUrl+"?ReadViewEntries"}a=Ext.apply({proxy:{type:"xnd-ajax",url:a.viewUrl}},a);if(!a.model&&a.fields){a.model=Ext.define("Extnd.data.ViewModel-"+(a.storeId||Ext.id()),{extend:"Extnd.data.ViewModel",fields:a.fields});b.implicitModel=true}b.removeCategoryTotal=true;b.previousStartMC=new Ext.util.MixedCollection();b.callParent([a]);if(b.category&&typeof b.category==="string"){b.extraParams.RestrictToCategory=b.category}},cleanUpConfig:function(a){if(a.viewName&&a.dbPath){a.viewUrl=a.dbPath+a.viewName}else{if(a.viewName&&!a.dbPath){a.dbPath=Extnd.session.currentDatabase?Extnd.session.currentDatabase.webFilePath:null;if(!a.dbPath){a.dbPath=location.pathname.split(/\.nsf/i)[0];a.dbPath=a.dbPath||a.dbPath+".nsf/"}a.viewUrl=a.dbPath+a.viewName}else{if(a.viewUrl){var b=a.viewUrl.lastIndexOf("/")+1;a.dbPath=a.viewUrl.substring(0,b);a.viewName=a.viewUrl.substring(b)}}}return a},load:function(a){var b=this;a=a||{};b.extraParams=b.extraParams||{};a.params=a.params||{};a.start=a.start||1;if(a.params.expand||a.params.expandview){if(b.extraParams.collapse){delete b.extraParams.collapse}if(b.extraParams.collapseview){delete b.extraParams.collapseview}}if(a.params.collapse||a.params.collapseview){if(b.extraParams.expand){delete b.extraParams.expand}if(b.extraParams.expandview){delete b.extraParams.expandview}}Ext.apply(a.params,b.extraParams);b.callParent([a])},loadRecords:function(b,c){var d=this,e,a;if(d.removeCategoryTotal){a=b.length;if(a>0){e=b[a-1];if(e.isCategoryTotal){b.pop()}}}d.callParent(arguments)},sortzz:function(c,a){var b=this.fields.get(c);if(!b){return false}if(!a){if(this.sortInfo&&this.sortInfo.field===b.name){a=(this.sortToggle[b.name]||"ASC").toggle("ASC","DESC")}else{a=b.sortDir}}this.sortToggle[b.name]=a;this.sortInfo={field:b.name,direction:a};if(!this.remoteSort){this.applySort();this.fireEvent("datachanged",this)}else{this.load(this.lastOptions)}},loadPage:function(c,a){var b=this;c=c.toString();b.currentStart=c;a=Ext.apply({start:c,limit:b.pageSize,addRecords:!b.clearOnPageLoad},a);if(b.buffered){a.start=parseInt(a.start.split(".")[0],10);return b.loadToPrefetch(a)}b.read(a)},prefetchPage:function(e,b){var d=this,a=d.pageSize||d.defaultPageSize,f=((e-1)*d.pageSize)+1,c=d.totalCount;if(c!==undefined&&d.getCount()===c){return}d.prefetch(Ext.applyIf({page:e,start:f,limit:a},b))},nextPage:function(a){var c=this,b=c.last(),d=b.position;if(b.isCategoryTotal){b=c.getAt(b.index-1);d=b.position}c.previousStartMC.add(d,b);c.loadPage(d,a)},previousPage:function(b){var c=this,e=c.first(),d=e.position,a=c.previousStartMC.indexOfKey(d),f;if(a!==-1){if(a===0){f=1}else{f=c.previousStartMC.get(a-1).position}}c.loadPage(f,b)}});Ext.define("Extnd.grid.ViewColumn",{extend:Ext.grid.column.Column,alias:["widget.xnd-viewcolumn"],alternateClassName:["Ext.nd.data.ViewColumn"],initComponent:function(){var b=this,a=b.isContained;b.datetimeformat=b.datetimeformat||{};b.numberformat=b.numberformat||{};Ext.applyIf(b,{dateTimeFormats:Extnd.dateTimeFormats||{},formatCurrencyFnc:Ext.util.Format.usMoney});b.resizable=b.isResize||b.resizable;b.text=b.title||b.text;b.callParent(arguments);if(!a.usingBufferedRenderer&&b.isResortAscending!==undefined){b.possibleSortStates=[];b.possibleSortStates.push(b.isResortAscending?"ASC":"RESTORE");b.possibleSortStates.push(b.isResortDescending?"DESC":"RESTORE");b.possibleSortStates.push("RESTORE")}},defaultRenderer:function(s,p,c,m,r,f){var y=this,a=y.up("grid"),j=c.entryData[y.dataIndex]||{},x="",o,q=f.getAt(m+1),w=c.columnIndentLevel,l='<img src="'+a.collapseIcon+'" style="vertical-align:bottom; margin-right:8px;"/>',e='<img src="'+a.expandIcon+'" style="vertical-align:bottom; margin-right:8px;"/>',g,n,k,v="",b="",d=y.getListSeparator(),h="",t,u=0;if(c.phantom===true){return(s===undefined)?"":s}if(s===null){return""}if(s&&s.split){s=s.split("\n");u=s.length}if(typeof s==="string"&&s===""&&!y.isResponse&&!j.category){return""}if(c.hasChildren()&&y.isCategory){n=j.indent;k=(n>0)?"padding-left:"+n*20+"px;":"";p.style="width: auto; white-space: nowrap; "+k;if(q){g=q.columnIndentLevel;if(g>w){p.tdCls=" xnd-view-collapse xnd-view-category";x=l+y.getValue(s,c)}else{p.tdCls=" xnd-view-expand xnd-view-category";x=e+y.getValue(s,c)}}else{p.tdCls=" xnd-view-expand xnd-view-category";x=e+y.getValue(s,c)}}else{if(!c.isCategory&&c.hasChildren()&&!c.isResponse&&y.isResponse){if(q){g=q.columnIndentLevel;if(g>w){p.tdCls="xnd-view-collapse xnd-view-response";x=l}else{p.tdCls="xnd-view-expand xnd-view-response";x=e}}else{p.tdCls="xnd-view-expand xnd-view-response";x=e}}else{if(c.hasChildren()&&c.isResponse&&y.isResponse){n=j.indent;k=(n>0)?"padding-left:"+(20+(n*20))+"px;":"";p.style="float: left; width: auto; white-space: nowrap; "+k;if(q){g=q.columnIndentLevel;if(g>w){p.tdCls="xnd-view-collapse xnd-view-response";x=l+y.getValue(s,c)}else{p.tdCls="xnd-view-expand xnd-view-response";x=e+y.getValue(s,c)}}else{p.tdCls="xnd-view-expand xnd-view-response";x=e+y.getValue(s,c)}}else{if(!c.hasChildren()&&c.isResponse&&y.isResponse){p.tdCls="xnd-view-response";n=j.indent;k=(n>0)?"padding-left:"+(20+(n*20))+"px;":"";p.style="float: left; width: auto; white-space: nowrap; "+k;x=y.getValue(s,c)}else{if(y.isIcon){for(t=0;t<u;t++){b=s[t];if(isNaN(parseInt(b,10))||b==="0"){x=""}else{o=(b<10)?"00"+b:(b<100)?"0"+b:(b>186)?"186":b;h=(y.listSeparator==="newline")?'style="clear: left;"':"";v='<div class="xnd-icon-vw xnd-icon-vwicn'+o+'" '+h+">&nbsp;</div>";if(t===0){x=v}else{x=x+d+v}}}}else{if(y.totals!=="none"){p.tdCls=" xnd-view-totals xnd-view-"+y.totals}x=y.getValue(s,c)}}}}}return x},getValue:function(o,j){var m=this,q,e,b,d,a=j.entryData[m.dataIndex]||{},n=a.type,f=m.numberformat,p=m.datetimeformat,h=m.getListSeparator(),c="",g,k,l="";if(m.isCategory&&o.length===0){d=m.notCategorizedText}o=(Ext.isArray(o))?o:[o];k=o.length;for(g=0,k;g<k;g++){q=(g+1<k)?h:"";d=o[g];if(m.isIcon){d=parseInt(d,10);if(isNaN(d)||d===0){d=""}else{d=(d<10)?"00"+d:(d<100)?"0"+d:(d>186)?"186":d;d='<img src="/icons/vwicn'+d+'.gif"/>'}}else{if(j.hasChildren()&&(m.totals==="percentoverall"||m.totals==="percentparent")){d=Ext.Number.toFixed(100*parseFloat(d),f.digits||0)+"%"}else{switch(n){case"datetimelist":case"datetime":if(p.show===undefined){p.show=m.dateTimeFormats.show}if(d.indexOf("T")>0){e=d.split(",")[0].replace("T",".");b="Ymd.His"}else{e=d;b="Ymd";p.show="date"}e=Ext.Date.parse(e,b);switch(p.show){case"date":d=e?Ext.Date.format(e,m.dateTimeFormats.dateFormat):"";break;case"datetime":d=e?Ext.Date.format(e,m.dateTimeFormats.dateTimeFormat):"";break}break;case"textlist":case"text":break;case"numberlist":case"number":d=parseFloat(d);switch(f.format){case"currency":d=Ext.isEmpty(d)?m.formatCurrencyFnc(0):m.formatCurrencyFnc(d);break;case"fixed":case"scientific":if(j.isCategoryTotal&&f.percent){d=Ext.Number.toFixed(100*d,f.digits)+"%"}else{d=Ext.Number.toFixed(d,f.digits)}break;default:}break;default:}}}l=l+d+q}return l},getListSeparator:function(){var a=this,b="";switch(a.listSeparator){case"none":b="";break;case"space":b=" ";break;case"comma":b=",";break;case"newline":b="<br/>";break;case"semicolon":b=";";break;default:b=""}return b},setSortState:function(a,i,f){var g=this,h=g.ascSortCls,c=g.descSortCls,b=g.nullSortCls,e=g.getOwnerHeaderCt(),d=g.sortState;a=a||null;if(!g.sorting&&d!==a&&g.getSortParam()){g.addCls(Ext.baseCSSPrefix+"column-header-sort-"+a);if(a&&!f){g.sorting=true;g.doSort(a);g.sorting=false}switch(a){case"DESC":g.removeCls([h,b]);break;case"ASC":g.removeCls([c,b]);break;case"RESTORE":g.removeCls([h,c,b]);break;case null:g.removeCls([h,c]);break}if(e&&!g.triStateSort&&!i){e.clearOtherSortStates(g)}g.sortState=a;if(g.triStateSort||a!==null){e.fireEvent("sortchange",e,g,a)}}},getSortColumn:function(){return this.position-1}});Ext.define("Extnd.data.ViewDesign",{mixins:{observable:Ext.util.Observable},alternateClassName:["Ext.nd.data.ViewDesign"],constructor:function(a){var b=this;b.mixins.observable.constructor.call(b);b.noteType="view";b.viewName="";b.multiExpand=false;b.storeConfig={};b.extraParams={};b.removeCategoryTotal=true;b.isCategorized=false;b.callback=Ext.emptyFn;Ext.apply(b,a);if(!b.viewUrl){b.viewUrl=b.dbPath+b.viewName}b.getViewDesign()},getViewDesign:function(){var a=this;Ext.Ajax.request({method:"GET",disableCaching:true,success:a.getViewDesignStep2,failure:a.getViewDesignFailure,scope:a,url:a.viewUrl+"?ReadDesign"})},getViewDesignStep2:function(c,e){var d=this,a=c.responseXML,f=Ext.DomQuery,b=f.select("column",a);d.visibleCols=new Ext.util.MixedCollection();Ext.each(b,function(j,g,i){var h=Ext.DomQuery.selectValue("@name",j);if(h!==undefined){d.visibleCols.add({id:h,name:h})}},this);Ext.Ajax.request({method:"GET",disableCaching:true,success:d.getViewDesignSuccess,failure:d.getViewDesignFailure,scope:d,url:Extnd.extndUrl+"DXLExporter?OpenAgent&db="+d.dbPath+"&type="+d.noteType+"&name="+d.viewName})},getViewDesignSuccess:function(F,b){var C=this,d=F.responseXML,r=Ext.DomQuery,h=r.select("column",d),D={},w=h.length,p=0,u,j,m=[],c,H,E,G,e,g,l,f,o,B,k,t,A={},y,z={},a,s,n,v,x;C.columns=new Ext.util.MixedCollection();for(x=0;x<w;x++){j=h[x];a=!!r.selectValue("@categorized",j,false);C.isCategorized=C.isCategorized||a;if(x===0&&C.isCategorized&&(typeof C.category==="string")){continue}u=p;H=r.selectValue("@itemname",j,"columnnumber_"+u);e=C.visibleCols.getByKey(H);if(!e){continue}p++;E=r.selectValue("columnheader/@title",j,"&nbsp;");g=r.selectValue("@resort",j,false);l=(g==="ascending"||g==="both")?true:false;f=(g==="descending"||g==="both")?true:false;o=(g==="toview")?true:false;B=(C.storeConfig.remoteSort===false)?true:(l||f)?true:false;k=r.selectValue("columnheader/@align",j,"left");t=r.select("datetimeformat",j)[0];if(t){A={show:r.selectValue("@show",t),date:r.selectValue("@date",t),time:r.selectValue("@time",t),zone:r.selectValue("@zone",t)}}y=r.select("numberformat",j)[0];if(y){z={format:r.selectValue("@format",y),digits:r.selectNumber("@digits",y),parens:!!r.selectValue("@parens",y,false),percent:!!r.selectValue("@percent",y,false),punctuated:!!r.selectValue("@punctuated",y,false)}}D={xtype:"xnd-viewcolumn",title:E,componentCls:o?"xnd-resorttoview":"",align:r.selectValue("@align",j,"left"),dataIndex:H,width:Math.max(r.selectNumber("@width",j)*11.28,22),totals:r.selectValue("@totals",j,"none"),sortable:B,isResortToView:o,resortToViewName:o?r.selectValue("@resorttoview",j,""):"",isResortAscending:l,isResortDescending:f,isCategory:a,isResize:!!r.selectValue("@resizable",j,false),listSeparator:r.selectValue("@listseparator",j,"none"),isResponse:!!r.selectValue("@responsesonly",j,false),isShowTwistie:!!r.selectValue("@twisties",j,false),isIcon:r.selectValue("@showasicons",j,false),datetimeformat:A,numberformat:z,position:u+1};c={name:H,column:u,type:"domino"};m.push(c);C.columns.add(H,D)}n=r.select("view",d);C.isView=(n.length>0)?true:false;C.isFolder=!C.isView;v=(C.isView)?"view":"folder";if(!C.autoExpandColumn){if(C.extendLastColumn===false){C.autoExpandColumn=false}else{if(C.extendLastColumn===true){C.autoExpandColumn=p-1}else{C.extendLastColumn=!!r.selectValue(v+"/@extendlastcolumn",d,false);C.autoExpandColumn=(C.extendLastColumn)?p-1:false}}}C.allowDocSelection=!!r.selectValue(v+"/@allowdocselection",d,false);s=r.selectValue(v+"/@type",d,"view");C.isCalendar=C.isCalendar||(s==="calendar"?true:false);C.dominoView={meta:{root:"viewentries",record:"viewentry",totalRecords:"@toplevelentries",id:"@position",columnConfig:C.columns,isCategorized:C.isCategorized,fromViewDesign:true},fields:m};C.setStore();if(C.scope){Ext.callback(C.callback,C.scope)}else{C.callback()}},setStore:function(){var b=this,a=Ext.define("Extnd.data.ViewModel-"+Ext.id(),{extend:"Extnd.data.ViewModel",fields:b.dominoView.fields});b.store=new Extnd.data[(b.isCategorized&&b.multiExpand)?"CategorizedStore":"ViewStore"](Ext.apply({model:a,dbPath:b.dbPath,viewName:b.viewName,viewUrl:b.viewUrl,extraParams:b.extraParams,removeCategoryTotal:b.removeCategoryTotal,remoteSort:true},b.storeConfig))},getViewDesignFailure:function(a,b){this.fireEvent("getdesignfailure",this,a,b)}});Ext.define("Extnd.grid.header.Container",{extend:Ext.grid.header.Container,alias:"widget.xnd-headercontainer",defaultType:"xnd-viewcolumn",enableColumnHide:true,showMenuBy:function(a,f){var c=this,d=c.getMenu(),e=d.down("#ascItem"),b=d.down("#descItem");if(c.usingBufferedRenderer){c.callParent(arguments)}else{if(f.isResortAscending!==undefined){d.activeHeader=d.ownerButton=f;f.setMenuActive(true);if(e){e[f.sortable&&f.isResortAscending?"enable":"disable"]()}if(b){b[f.sortable&&f.isResortDescending?"enable":"disable"]()}d.showBy(a)}else{c.callParent(arguments)}}}});Ext.define("Extnd.toolbar.Paging",{extend:Ext.toolbar.Paging,alias:["widget.xnd-pagingtoolbar","widget.xnd-paging"],alternateClassName:["Extnd.PagingToolbar","Ext.nd.PagingToolbar"],beforePageText:"Showing entries ",afterPageText:" - {0}",middlePageText:" of ",initComponent:function(){var a=this;a.callParent(arguments);Ext.each(this.items.items,function(d,b,c){if(d.getXType&&d.isXType("numberfield",true)){c[b]=this.inputItem=new Ext.form.TextField(Ext.apply(d.initialConfig,{grow:true}))}},this)},onPagingKeyDownzzz:function(b,a){},moveFirst:function(){var a=this;if(a.fireEvent("beforechange",a)!==false){a.store.loadPage("1")}},movePrevious:function(){var a=this;if(a.fireEvent("beforechange",a)!==false){a.store.previousPage()}},moveNext:function(){var a=this;if(a.fireEvent("beforechange",a)!==false){a.store.nextPage()}},moveLast:function(){var c=this,d,b=c.store.getTotalCount(),a=b%c.store.pageSize;d=c.isCategorized?b:a?(b-a):b-c.store.pageSize+1;if(c.fireEvent("beforechange",c)!==false){c.store.loadPage(d)}},onLoad:function(){var f=this,b,c,e,a,d,g;d=f.store.getCount();g=d===0;if(!g){b=f.getPageData();c=b.currentStart;e=b.toRecord;a=Ext.String.format(f.afterPageText,e)}else{c="1";e="1";a=Ext.String.format(f.afterPageText,0)}Ext.suspendLayouts();f.child("#afterTextItem").setText(a);f.child("#inputItem").setDisabled(g).setValue(c);f.child("#first").setDisabled(c==="1"||g);f.child("#prev").setDisabled(c==="1"||g);f.child("#next").setDisabled(c===e||g);f.child("#last").setDisabled(c===e||g);f.child("#refresh").enable();f.updateInfo();Ext.resumeLayouts(true);if(f.rendered){f.fireEvent("change",f,b)}},getPageData:function(){var b=this.store,a=b.getTotalCount(),d=b.first(),c=b.last();return{total:a,currentStart:b.currentStart,fromRecord:d?d.position:0,toRecord:c?c.position:0}}});Ext.define("Extnd.util.Iframe",{singleton:true,alternateClassName:["Ext.nd.util.Iframe"],add:function(d){var k,j=false,f=false,b=false,g=false,l,m,i,n,h,e,a,o,c;m=d.documentLoadingWindowTitle||(d.uiDocument?d.uiDocument.documentLoadingWindowTitle:(d.uiView?d.uiView.documentLoadingWindowTitle:"Opening"));i=d.documentUntitledWindowTitle||(d.uiDocument?d.uiDocument.documentUntitledWindowTitle:(d.uiView?d.uiView.documentUntitledWindowTitle:"(Untitled)"));n=d.useDocumentWindowTitle||(d.uiDocument?d.uiDocument.useDocumentWindowTitle:(d.uiView?d.uiView.useDocumentWindowTitle:true));h=d.documentWindowTitleMaxLength||(d.uiDocument?d.uiDocument.documentWindowTitleMaxLength:(d.uiView?d.uiView.documentWindowTitleMaxLength:16));e=d.targetDefaults||(d.uiDocument?d.uiDocument.targetDefaults:(d.uiView?d.uiView.targetDefaults:{}));k=(d.target.getXType)?d.target:Ext.getCmp(d.target);k=(k&&k.getXType)?k:Ext.get(k);if(!k){window.open(d.url);return}if(k.add){l=k;if(l.items){b=l.items.get(d.id)}}else{f=Ext.get(k)}if(!b){a="if-"+d.id;o=Ext.apply({html:"<iframe id='"+a+"' src='"+d.url+"' frameBorder='0' width='100%' height='100%'/>",title:d.title||m,layout:"fit",id:d.id,closable:true},d.targetDefaults);if(l){if(l.getXType()==="window"){l.removeAll()}b=l.add(o);if(window===window.top){b.on("beforedestroy",function(p){if(Ext!==undefined){c=Ext.DomQuery.selectNode("iframe",p.body.dom);if(c){if(c.src){c.src="javascript:false";Ext.removeNode(c)}}}})}b.on("afterrender",function(p){var t,s,r=Ext.DomQuery.selectNode("iframe",p.body.dom),q=Ext.isIE?"onreadystatechange":"onload";r[q]=Ext.bind(function(){try{t=this.contentWindow||window.frames[this.name];t.ownerCt=p;if(d.uiView){t.uiView=d.uiView}if(l){t.target=l}}catch(v){}if(n){try{s=t.document.title;if(s!==""){if(h!==-1){p.setTitle(Ext.util.Format.ellipsis(s,h))}else{p.setTitle(s)}}else{if(p.title!==d.title&&d.title!==m){p.setTitle(i)}}}catch(u){if(p.title!==d.title&&p.title!==m){p.setTitle(i)}}}},r)})}else{if(f){b=new Ext.Panel(o)}}}if(b.show){b.show()}if(k.show){k.show()}}});Ext.define("Extnd.toolbar.Actionbar",{extend:Ext.toolbar.Toolbar,alias:"widget.xnd-actionbar",alternateClassName:["Extnd.Actionbar","Ext.nd.Actionbar"],noteType:"",noteName:"",createActionsFrom:"dxl",dominoActionbar:null,actions:null,useViewTitleFromDxl:false,convertFormulas:true,enableOverflow:true,init:function(b){var a=this;a.toolbar=b;a.dominoActionbar={};a.actions=[];if(a.toolbar.getXType()==="xnd-actionbar"){a.toolbar.on("actionsloaded",a.addActions,this)}else{a.addActions()}},initComponent:function(){var b=this,a;b.dominoActionbar={};b.actions=[];if(!Ext.isEmpty(b.useDxl)&&b.useDxl===false){b.createActionsFrom="document"}b.noteUrl=b.noteUrl||b.dbPath+b.noteName;if(b.noteName===""){a=b.noteUrl.lastIndexOf("/")+1;b.dbPath=b.noteUrl.substring(0,a);b.noteName=b.noteUrl.substring(a)}b.addEvents("actionsloaded");if(!b.isPlugin){b.callParent(arguments);b.toolbar=this}},afterRender:function(){this.callParent(arguments);this.addActions()},addActions:function(){var a=this;if(a.noteType===""||a.noteType==="view"){a.dominoActionbar.actionbar=false}else{a.dominoActionbar=new Extnd.util.DominoActionbar();a.dominoActionbar.hide()}if(a.createActionsFrom==="document"){a.addActionsFromDocument()}else{if(a.noteName===""){a.fireEvent("actionsloaded",a.toolbar)}else{a.addActionsFromDxl()}}},addActionsFromDxl:function(){var a=this;Ext.Ajax.request({method:"GET",disableCaching:true,success:a.addActionsFromDxlSuccess,failure:a.addActionsFromDxlFailure,scope:a,url:Ext.nd.extndUrl+"DXLExporter?OpenAgent&db="+a.dbPath+"&type="+a.noteType+"&name="+a.noteName})},addActionsFromDxlSuccess:function(o){var me=this,q=Ext.DomQuery,response=o.responseXML,arActions=q.select("action",response),aLen=arActions.length,curLevelTitle="",isFirst=false,show,action,title,hidewhen,showinbar,iconOnly,icon,imageRef,syscmd,arHide,lotusscript,slashLoc,isSubAction,arLevels,iLevels,tmpCurLevelTitle,tmpOnClick,handler,formula,cmdFrm,i,h;if(me.noteType==="view"&&me.getTarget()&&me.useViewTitleFromDxl){me.setViewName(response)}for(i=0;i<aLen;i++){show=true;action=arActions[i];title=q.selectValue("@title",action,"");hidewhen=q.selectValue("@hide",action,null);showinbar=q.selectValue("@showinbar",action,null);iconOnly=q.select("@onlyiconinbar",action);icon=q.selectNumber("@icon",action,null);imageRef=q.selectValue("imageref/@name",action,null);syscmd=q.selectValue("@systemcommand",action,null);if(hidewhen){arHide=hidewhen.split(" ");for(h=0;h<arHide.length;h++){if(arHide[h]==="web"||(Ext.nd.currentUIDocument!==undefined&&(arHide[h]==="edit"&&Ext.nd.currentUIDocument.editMode)||(arHide[h]==="read"&&!Ext.nd.currentUIDocument.editMode))){show=false}}}if(showinbar==="false"){show=false}lotusscript=Ext.DomQuery.selectValue("lotusscript",action,null);if(lotusscript){show=false}if(icon){if(icon<10){imageRef="00"+icon}else{if(icon<100){imageRef="0"+icon}else{imageRef=""+icon}}imageRef="/icons/actn"+imageRef+".gif"}else{if(imageRef){imageRef=(imageRef.indexOf("/")===0)?imageRef:this.dbPath+imageRef}}if(show&&syscmd===null){slashLoc=title.indexOf("\\");if(slashLoc>0){isSubAction=true;arLevels=title.split("\\");iLevels=arLevels.length;tmpCurLevelTitle=title.substring(0,slashLoc);title=title.substring(slashLoc+1);if(tmpCurLevelTitle!==curLevelTitle){curLevelTitle=tmpCurLevelTitle;isFirst=true}else{isFirst=false}}else{isSubAction=false;curLevelTitle=""}tmpOnClick=Ext.DomQuery.selectValue("javascript",action,null);handler=Ext.emptyFn;if(tmpOnClick){handler=Ext.bind((function(){var bleh=tmpOnClick;return function(){return eval(bleh)}}()),this)}else{if(this.convertFormulas){formula=Ext.DomQuery.selectValue("formula",action,null);if(formula){cmdFrm=formula.match(/\@Command\(\[(\w+)\](?:;"")*(?:;"(.+?)")*\)/);if(cmdFrm&&cmdFrm.length){switch(cmdFrm[1]){case"Compose":handler=Ext.bind(this.openForm,this,[cmdFrm[2]]);break;case"EditDocument":handler=Ext.bind(this.editDocument,this,[cmdFrm[2]?((cmdFrm[2]==="1")?true:false):true]);break;case"OpenDocument":handler=Ext.bind(this.openDocument,this,[cmdFrm[2]?((cmdFrm[2]==="1")?true:false):true]);break;case"FileCloseWindow":handler=Ext.bind(this.getUIDocument().close,this.getUIDocument(),[]);break;case"FileSave":handler=Ext.bind(this.getUIDocument().save,this.getUIDocument(),[{}]);break;case"EditDeselectAll":handler=Ext.bind(this.getUIView().deselectAll,this.getUIView(),[]);break;case"ViewCollapseAll":handler=Ext.bind(this.getUIView().collapseAll,this.getUIView(),[]);break;case"ViewExpandAll":handler=Ext.bind(this.getUIView().expandAll,this.getUIView(),[]);break;case"FilePrint":case"FilePrintSetup":handler=Ext.bind(this.print,this);break;case"OpenView":case"RunAgent":default:show=false}}}}}if(isSubAction){if(isFirst){if(i>0){this.actions.push("-")}this.actions.push({text:curLevelTitle,menu:{items:[{text:title,cls:(icon||imageRef)?"x-btn-text-icon":null,icon:imageRef,handler:handler}]}})}else{this.actions[this.actions.length-1].menu.items.push({text:title,cls:(icon||imageRef)?"x-btn-text-icon":null,icon:imageRef,handler:handler})}}else{if(i>0){this.actions.push("-")}this.actions.push({text:title,cls:(icon||imageRef)?"x-btn-text-icon":null,icon:imageRef,handler:handler})}}}this.processActions();this.removeDominoActionbar();this.fireEvent("actionsloaded",this.toolbar)},addActionsFromDxlFailure:function(a){},addActionsFromDocument:function(o){var me=this,arActions=[],q=Ext.DomQuery,curLevelTitle="",isFirst=false,action,title,slashLoc,imageRef,i,aLen,len,cls,arLevels,iLevels,tmpCurLevelTitle,handler,sHref,tmpOnClick,oOnClick,arOnClick,isSubAction;if(this.dominoActionbar.actionbar){arActions=q.select("a",this.dominoActionbar.actionbar)}aLen=arActions.length;for(i=0;i<aLen;i++){action=arActions[i];title=action.lastChild.nodeValue;slashLoc=title?title.indexOf("\\"):-1;imageRef=q.selectValue("img/@src",action,null);imageRef=(imageRef===null)?null:(imageRef&&(imageRef.indexOf("/")===0||imageRef.indexOf("http")===0))?imageRef:this.dbPath+imageRef;cls=(title===null)?"x-btn-icon":imageRef?"x-btn-text-icon":null;if(slashLoc>0){isSubAction=true;arLevels=title.split("\\");iLevels=arLevels.length;tmpCurLevelTitle=title.substring(0,slashLoc);title=title.substring(slashLoc+1);if(tmpCurLevelTitle!==curLevelTitle){curLevelTitle=tmpCurLevelTitle;isFirst=true}else{isFirst=false}}else{isSubAction=false;curLevelTitle=""}sHref=action.getAttribute("href",2);if(sHref!==""){tmpOnClick="location.href = '"+sHref+"';"}else{oOnClick=action.attributes.onclick;if(oOnClick){tmpOnClick=oOnClick.nodeValue}else{tmpOnClick=""}if(tmpOnClick.indexOf("return _doClick")===0){tmpOnClick=tmpOnClick.substring(7)}arOnClick=tmpOnClick.split("\r");len=arOnClick.length;if(len===1){arOnClick=tmpOnClick.split("\n");len=arOnClick.length}if(arOnClick[len-1]==="return false;"){arOnClick.splice(arOnClick.length-1,1)}tmpOnClick=arOnClick.join(" ")}handler=Ext.bind((function(){var bleh=tmpOnClick;return function(){return eval(bleh)}}()),this);if(isSubAction){if(isFirst){if(i>0){this.actions.push("-")}this.actions.push({text:curLevelTitle,menu:{items:[{text:title,cls:cls,icon:imageRef,handler:handler}]}})}else{this.actions[this.actions.length-1].menu.items.push({text:title,cls:cls,icon:imageRef,handler:handler})}}else{if(i>0){this.actions.push("-")}this.actions.push({text:title,cls:cls,icon:imageRef,handler:handler})}}this.processActions();this.removeDominoActionbar();this.fireEvent("actionsloaded",this)},removeDominoActionbar:function(){if(this.dominoActionbar.remove){this.dominoActionbar.remove()}},removeActionbar:function(){this.toolbar.destroy()},processActions:function(){var a=this,b=a.actions.length;if(b>0){Ext.each(a.actions,function(d){a.toolbar.add(d)},a)}else{if(a.removeEmptyActionbar){a.removeActionbar()}}},setViewName:function(a){var d=this,e=Ext.DomQuery,b=e.selectValue("view/@name",a),c;if(b===undefined){b=e.selectValue("folder/@name",a)}if(!d.getUIView().showFullCascadeName){c=b.lastIndexOf("\\");if(c!==-1){b=b.substring(c+1)}}if(d.tabPanel){d.tabPanel.activeTab.setTitle(b)}},openForm:function(j){var e=this,h,c,a,i,f,d,b,g;if(typeof j==="string"){h=j;c=e.dbPath;a=false;d=e.getTarget()}else{h=j.formName;c=j.dbPath||e.dbPath;a=j.isResponse||false;d=j.target||e.getTarget();g=j.title}i="";if(a){b=j.parentUNID||e.getParentUNID();i=(b!=="")?"&parentUNID="+b:""}f=c+h+"?OpenForm"+i;if(!d){window.open(f)}else{Extnd.util.Iframe.add({target:d,uiView:e.getUIView(),uiDocument:e.getUIDocument(),url:f,title:g,id:Ext.id()})}},getParentUNID:function(){var b=this,a="",c,d;if(b.noteType==="view"){c=b.getUIView().getSelectionModel().getSelected();if(c&&c.unid){a=c.unid}}else{d=b.getUIDocument();a=(d&&d.document&&d.document.universalID)?d.document.universalID:""}return a},openDocument:function(d){var c=this,e=c.getTarget(),f,a,b;if(c.noteType==="view"){c.getUIView().openDocument(d);return}if(d){c.getUIDocument().edit()}else{f=d?"?EditDocument":"?OpenDocument";a=c.getUIDocument().document.universalID;b=c.dbPath+"0/"+a+f;if(!e){location.href=b}else{Extnd.util.Iframe.add({target:e,uiView:c.getUIView(),uiDocument:c.getUIDocument(),url:b,id:Ext.id()})}}},editDocument:function(b){var a=this;if(a.noteType==="view"){a.getUIView().openDocument(b)}else{a.getUIDocument().edit()}},print:function(){window.print()},unsupportedAtCommand:function(a){Ext.Msg.alert("Error",'Sorry, the @command "'+a+'" is not currently supported by Ext.nd')},getTarget:function(){var a=this;if(a.target){return a.target}else{if(window&&window.target){a.target=window.target;return a.target}else{if(a.ownerCt&&a.ownerCt.ownerCt&&a.ownerCt.ownerCt.getXType&&a.ownerCt.ownerCt.getXType()==="tabpanel"){a.target=a.ownerCt.ownerCt.id;return a.target}else{return null}}}},getUIView:function(){var a=this;if(!a.uiView){if(a.ownerCt&&a.ownerCt.getXType()==="xnd-uiview"){a.uiView=a.ownerCt}else{a.uiView=null}}return a.uiView},getUIDocument:function(){var a=this;if(!a.uiDocument){if(a.ownerCt&&a.ownerCt.getXType()==="xnd-uidocument"){a.uiDocument=a.ownerCt}else{a.uiDocument=null}}return a.uiDocument}});Ext.define("Extnd.toolbar.plugin.SingleCategoryCombo",{extend:Ext.AbstractPlugin,alias:"plugin.xnd-view-singlecategorycombo",mixins:{observable:Ext.util.Observable},count:-1,value:"",viewUrl:"",categoryComboBoxEmptyText:"Select a category...",constructor:function(a){var b=this;b.addEvents("categorychange");b.callParent(arguments);b.mixins.observable.constructor.call(b)},init:function(b){var a;this.toolbar=b;if(this.toolbar.isXType("xnd-actionbar",true)){this.toolbar.on("actionsloaded",this.createCombo,this)}else{this.toolbar.on("render",this.createCombo,this)}this.on("categorychange",this.onCategoryChange,this);if(this.listeners){this.on(this.listeners);delete this.listeners}a=Ext.define("Extnd.data.model.SingleCategory-"+Ext.id(),{extend:"Extnd.data.ViewModel",fields:[{name:"category",mapping:"entrydata[category=true]",type:"string"}]});this.store=Ext.create("Extnd.data.ViewStore",{model:a,viewUrl:this.toolbar.getUIView().viewUrl});this.store.load({params:{collapseview:true,count:this.count}})},createCombo:function(){var a="xnd-search-combo-"+Ext.id();this.combo=this.toolbar.add({xtype:"combo",store:this.store,displayField:"category",typeAhead:true,queryMode:"local",triggerAction:"all",emptyText:this.categoryComboBoxEmptyText,value:this.value,width:120,selectOnFocus:true,grow:true,listeners:{change:this.onCategoryChange,scope:this}})},onComboSelect:function(c,a,b){this.fireEvent("categorychange",c,a,b)},onCategoryChange:function(d,c,b){var e=this.toolbar.getUIView(),a=e.getStore();a.extraParams.RestrictToCategory=c;a.load({params:{start:1}})}});Ext.define("Extnd.toolbar.plugin.SearchField",{extend:Ext.AbstractPlugin,alias:"plugin.xnd-view-search",alternateClassName:["Extnd.SearchPlugin","Ext.nd.SearchPlugin"],mixins:{observable:Ext.util.Observable},align:null,iconCls:"icon-magnifier",searchText:"Search",labelWidth:50,pageSize:undefined,emptyText:"Search view...",searchTipText:"Type a text to search and press Enter",minCharsTipText:"Type at least {0} characters",width:220,shortcutKey:"r",shortcutModifier:"alt",constructor:function(a){var b=this;b.addEvents("beforesearch");b.callParent(arguments);b.mixins.observable.constructor.call(b)},init:function(a){this.toolbar=a;if(this.toolbar.isXType("xnd-actionbar",true)){this.toolbar.on("actionsloaded",this.addSearchField,this)}else{this.toolbar.on("render",this.addSearchField,this)}},addSearchField:function(){var b,a;this.uiView=this.toolbar.up("grid");if("right"===this.align){this.toolbar.add("->")}else{if(0<this.toolbar.items.getCount()){this.toolbar.add("-")}}this.field=new Ext.form.field.Trigger({fieldLabel:this.searchText,labelAlign:"right",labelWidth:this.labelWidth,preventMark:true,allowBlank:false,allowOnlyWhitespace:false,emptyText:this.emptyText,width:this.width,minLength:this.minLength,selectOnFocus:undefined===this.selectOnFocus?true:this.selectOnFocus,trigger1Cls:"x-form-clear-trigger",trigger2Cls:"x-form-search-trigger",scope:this,onTrigger1Click:Ext.bind(this.onTriggerClear,this),onTrigger2Click:Ext.bind(this.onTriggerSearch,this)});this.field.on("render",function(){this.field.el.dom.qtip=this.minChars?String.format(this.minCharsTipText,this.minChars):this.searchTipText;if(this.minChars){this.field.el.on({scope:this,buffer:300,keyup:this.onKeyUp})}var c=new Ext.util.KeyMap({target:this.field.el,binding:[{key:Ext.EventObject.ENTER,scope:this,fn:this.onTriggerSearch},{key:Ext.EventObject.ESC,scope:this,fn:this.onTriggerClear}]});c.stopEvent=true},this,{single:true});this.toolbar.add(this.field);if(this.shortcutKey&&this.shortcutModifier){b=this.uiView.getEl();a=[{key:this.shortcutKey,scope:this,stopEvent:true,fn:function(){this.field.focus()}}];a[0][this.shortcutModifier]=true;this.keymap=new Ext.KeyMap({target:b,bindings:a})}if(true===this.autoFocus){this.uiView.getStore().on({scope:this,load:function(){this.field.focus()}})}},onKeyUp:function(){var a=this.field.getValue().toString().length;if(0===a||this.minChars<=a){this.onTriggerSearch()}},onTriggerClear:function(){if(this.isSearching){var a=this.uiView.down("pagingtoolbar");if(a){a.unbind(this.uiView.getStore());a.bind(this.oldDataStore)}this.uiView.reconfigure(this.oldDataStore);this.uiView.getStore().load({params:{start:1}});this.isSearching=false}if(this.field.getValue()){this.field.setValue("");this.field.focus()}},onTriggerSearch:function(){var c=this,e=c.field.getValue(),d=c.uiView,f,b,a;if(!c.field.isValid()){return}f={db:d.dbPath.substring(0,d.dbPath.length-1),vw:d.viewName};if(!c.isSearching){c.oldDataStore=d.getStore();if(c.oldDataStore.extraParams.RestrictToCategory){f=Ext.apply(f,{RestrictToCategory:c.oldDataStore.extraParams.RestrictToCategory})}b=new Extnd.data.ViewStore({proxy:{type:"xnd-ajax",url:Extnd.extndUrl+"SearchView?OpenAgent"},model:c.oldDataStore.model,extraParams:f,remoteSort:false});d.reconfigure(b);a=d.down("pagingtoolbar");if(a){a.unbind(c.oldDataStore);a.bind(b)}c.isSearching=true}d.getStore().load({params:{query:e,count:c.searchCount||c.oldDataStore.pageSize,start:1}})},setDisabled:function(){this.field.setDisabled.apply(this.field,arguments)},enable:function(){this.setDisabled(false)},disable:function(){this.setDisabled(true)}});Ext.define("Extnd.grid.Panel",{extend:Ext.grid.Panel,alias:["widget.xnd-uiview","widget.xnd-gridpanel","widget.xnd-grid"],alternateClassName:["Extnd.UIView","Ext.nd.UIView","Ext.nd.GridPanel"],viewType:"gridview",layout:"fit",showActionbar:true,showPagingToolbar:true,showSearch:true,showSearchPosition:"bottom",showCategoryComboBox:false,showCategoryComboBoxPosition:"top",buildActionBarFromDXL:true,editMode:true,multiExpand:false,multiExpandCount:40,notCategorizedText:"(Not Categorized)",loadInitialData:true,documentWindowTitle:"",documentLoadingWindowTitle:"Opening...",documentUntitledWindowTitle:"(Untitled)",documentWindowTitleMaxLength:16,useDocumentWindowTitle:true,extendLastColumn:undefined,loadMask:true,noteType:"view",count:40,isCategorized:false,needsColumns:false,needsModel:false,constructor:function(a){a=this.cleanUpConfig(a);this.callParent([a])},cleanUpConfig:function(a){if(a.store){a.viewName=a.viewName||a.store.viewName;a.dbPath=a.dbPath||a.store.dbPath;a.viewUrl=a.viewUrl||a.store.viewUrl}if(a.viewName&&a.dbPath){a.viewUrl=a.dbPath+a.viewName}else{if(a.viewName&&!a.dbPath){a.dbPath=Extnd.session.currentDatabase?Extnd.session.currentDatabase.webFilePath:null;if(!a.dbPath){a.dbPath=location.pathname.split(/\.nsf/i)[0];a.dbPath=a.dbPath||a.dbPath+".nsf/"}a.viewUrl=a.dbPath+a.viewName}else{if(a.viewUrl){var b=a.viewUrl.lastIndexOf("/")+1;a.dbPath=a.viewUrl.substring(0,b);a.viewName=a.viewUrl.substring(b)}}}return a},initComponent:function(){var a=this;a.tbarPlugins=[];a.bbarPlugins=[];a.setupToolbars();Ext.applyIf(a,{store:a.createStore(),bbar:a.getBottomBarCfg(),collapseIcon:Extnd.extndUrl+"resources/images/minus.gif",expandIcon:Extnd.extndUrl+"resources/images/plus.gif",dateTimeFormats:Extnd.dateTimeFormats,formatCurrencyFnc:Ext.util.Format.usMoney,quickSearchKeyStrokes:[],targetDefaults:{},colsFromDesign:[],extraParams:{},selModel:{mode:"MULTI",allowDeselect:true},selType:"rowmodel",quickSearchConfig:{width:200},storeConfig:{pageSize:40}});a.createColumnHeader();if(typeof a.category==="string"){a.extraParams.RestrictToCategory=a.category}a.addEventListeners();a.callParent(arguments)},createColumnHeader:function(){var b=this,c=b.columns,a=b.findPlugin("bufferedrenderer")?true:false;if(c){b.needsColumns=false;b.columns=new Extnd.grid.header.Container({usingBufferedRenderer:a,items:c})}else{b.needsColumns=true;b.columns=new Extnd.grid.header.Container({usingBufferedRenderer:a,items:[{dataIndex:"dummy",header:"&nbsp;",flex:1}]})}},createStore:function(){var b=this,a;if(!b.store){b.needsModel=true;b.dmyId="xnd-dummy-store-"+Ext.id();a=Ext.create("Ext.data.Store",{id:b.dmyId,fields:["dummy"]})}else{b.needsModel=false}return a},onRender:function(){var a=this;a.callParent(arguments);if(a.needsColumns||a.needsModel){a.getViewDesign()}else{if(a.showPagingToolbar){a.updatePagingToolbar()}if(a.loadInitialData){a.store.loadPage(1)}a.fireEvent("open",a)}},addEventListeners:function(){this.on("itemdblclick",this.gridHandleRowDblClick,this);this.on("headerclick",this.gridHandleHeaderClick,this,true)},gridHandleRowDblClick:function(b,a,f,c,g,d){if(a&&a.unid){if(this.fireEvent("beforeopendocument",this,a,g)!==false){this.openDocument(this,a,g)}}},gridHandleHeaderClick:function(f,g,h){var c,d,k,j,b,i,a=f.up("grid");if(!a.region){if(g.isResortToView&&g.resortToViewName!==""){h.stopPropagation();k=this.viewUrl;k=k.substring(0,k.lastIndexOf("/")+1);delete this.viewName;delete a.viewName;delete this.initialConfig.viewName;delete a.initialConfig.viewName;if(a.ownerCt&&a.ownerCt.remove){c={viewUrl:k+g.resortToViewName};Ext.applyIf(c,a.initialConfig);b=a.ownerCt;j=b.items.indexOf(a);b.remove(a,true);d=b.insert(j,new Extnd.UIView(c));if(d.show){d.show()}b.doLayout()}else{i=a.container;c=Ext.applyIf({viewUrl:k+g.resortToViewName,renderTo:i},a.initialConfig);a.destroy();d=new Extnd.UIView(c);d.on("render",function(){d.doLayout()},this)}return false}else{return true}}else{return true}},getDocuments:function(){return this.getSelectionModel().getSelection()},getSelectedDocument:function(e){var c,d,a,b;if(e){c=this.getStore().getAt(e)}else{d=this.getSelectionModel();a=d.selections;c=d.selections.itemAt(a.length-1)}if(c&&c.unid){b=c}else{b=undefined}return b},editDocument:function(){this.openDocument(this,null,null,true)},openDocument:function(c,a,h,g){var i,b,d,f;if(arguments.length<=1){g=(arguments.length===1)?arguments[0]:false;c=this;h=null}i=g?"?EditDocument":"?OpenDocument";if(a===undefined){return}if(!a.unid){return}if(this.fireEvent("beforeopendocument",c,a,h,g)!==false){b="pnl-"+a.unid;d=this.viewUrl+"/"+a.unid+i;f=this.getTarget();if(!f){window.open(d)}else{Extnd.util.Iframe.add({target:f||this.ownerCt,uiView:this,url:d,id:a.unid})}}},getViewDesign:function(){var a=this;a.viewDesign=Ext.create("Extnd.data.ViewDesign",{dbPath:a.dbPath,viewName:a.viewName,category:a.category,multiExpand:a.multiExpand,storeConfig:a.storeConfig,extraParams:a.extraParams,removeCategoryTotal:false,callback:a.getViewDesignCB,scope:a})},getViewDesignCB:function(e){var d=this,f,b,a,c;d.isCategorized=d.viewDesign.dominoView.meta.isCategorized;d.isCalendar=d.viewDesign.dominoView.meta.isCalendar;d.allowDocSelection=d.viewDesign.allowDocSelection;d.autoExpandColumn=d.viewDesign.autoExpandColumn;d.isView=d.viewDesign.isView;d.isFolder=d.viewDesign.isFolder;d.colsFromDesign.length=0;a=d.viewDesign.columns.items.length;for(c=0;c<a;c++){b=d.viewDesign.columns.items[c];d.colsFromDesign.push(b)}if(d.isCategorized&&d.multiExpand){d.view=new Extnd.CategorizedView({});d.enableColumnMove=false;d.view.init(d);d.view.render()}else{d.on("cellclick",d.gridHandleCellClick,d,true)}if(!d.view){d.view=d.getView()}if(d.needsColumns){d.reconfigure(d.viewDesign.store,d.colsFromDesign)}else{d.reconfigure(d.viewDesign.store)}delete d.viewDesign.store;if(d.loadInitialData){d.store.loadPage(1)}if(d.showPagingToolbar){d.updatePagingToolbar()}d.fireEvent("getdesignsuccess",d);d.fireEvent("open",d)},updatePagingToolbar:function(){var a=this,b=a.down("xnd-pagingtoolbar");if(b){b.isCategorized=a.isCategorized;b.bindStore(null);b.bindStore(a.store);b.updateInfo()}},gridHandleCellClick:function(a,i,m,d,b,k,q){var r=this,h=Ext.get(q.getTarget()),c=false,s={},g=a.getStore(),o=g.lastOptions.params.count||r.count,n,f,j,l,p;if(h.dom.tagName==="IMG"){n=h.findParent("td.xnd-view-category");c=n;if(!n){f=h.findParent("td.xnd-view-response");c=f}if(c){j=Ext.get(c);l=j.hasCls("xnd-view-expand");if(l){s={count:((o!==undefined)&&o!==-1)?k+r.count:o,expand:d.position};g.load({params:s})}else{p=j.hasCls("xnd-view-collapse");if(p){s={count:(o!==undefined)?o:r.count,collapse:d.position};g.load({params:s})}}}}},getPlugins:function(){var a=this,c,b;if(a.showCategoryComboBox){c=Ext.create("Extnd.toolbar.plugin.SingleCategoryCombo",{viewUrl:a.viewUrl,value:a.category,count:a.categoryComboBoxCount||-1});if(a.category===undefined){a.category=""}if(a.showCategoryComboBoxPosition==="top"){a.tbarPlugins.push(c)}else{a.bbarPlugins.push(c)}}if(a.showSearch){b=Ext.create("Extnd.toolbar.plugin.SearchField",{});if(a.showSearchPosition==="top"){a.tbarPlugins.push(b)}else{a.bbarPlugins.push(b)}}},setupToolbars:function(){this.getPlugins();var a="xnd-view-toolbar-"+Ext.id();if(this.tbar){if(Ext.isArray(this.tbar)){this.tbar=new Extnd.toolbar.Actionbar({id:a,noteName:"",uiView:this,target:this.getTarget()||null,items:this.tbar,plugins:this.tbarPlugins})}else{if(this.tbar.add){this.tbar.add(this.tbarPlugins)}this.tbar.uiView=this;this.tbar.id=a}}else{if(this.showActionbar){this.tbar=new Extnd.toolbar.Actionbar({id:a,noteType:this.noteType,dbPath:this.dbPath,noteName:this.viewName,uiView:this,useDxl:this.buildActionBarFromDXL,useViewTitleFromDxl:this.useViewTitleFromDxl,removeEmptyActionbar:this.removeEmptyActionbar,target:this.getTarget()||null,plugins:this.tbarPlugins})}else{if(this.tbarPlugins.length>0){this.tbar=new Extnd.toolbar.Actionbar({id:a,noteName:"",uiView:this,target:this.getTarget()||null,plugins:this.tbarPlugins})}}}},getTarget:function(){var a=this,b=null;if(a.target){b=a.target}else{if(window&&window.target){a.target=window.target;b=a.target}else{if(a.ownerCt&&a.ownerCt.getXType&&a.ownerCt.getXType()==="tabpanel"){a.target=a.ownerCt.id;b=a.target}}}return b},getBottomBarCfg:function(){var a=this;if(a.showPagingToolbar){return{xtype:"xnd-pagingtoolbar",displayInfo:true,store:a.store,plugins:a.bbarPlugins}}},expandAll:function(){this.ecAll("expandview")},collapseAll:function(){this.ecAll("collapseview")},ecAll:function(c){var a=this.getStore(),b={};b[c]="true";a.load({params:b})}});Ext.define("Extnd.form.PickListFieldTypeAhead",{extend:Ext.form.TextField,alias:"widget.xnd-picklist-typeahead",view:null,queryParam:"startKey",initComponent:function(){var a=this;a.enableKeyEvents=true;a.callParent(arguments);a.on("keyup",a.onKeyUp,a,{buffer:300})},onKeyUp:function(c){var a=this,b={params:{}};b.params[a.queryParam]=a.getValue();a.view.getStore().load(b)}});Ext.define("Extnd.UIWorkspace",{constructor:function(a){this.sess=Extnd.session;this.db=this.sess.currentDatabase;this.dbPath=this.db.webFilePath;Ext.apply(this,a)},pickList:function(p){var j,f,d,e,c,l,k,g,n,b,o,h,m,i,a={type:"custom",multipleSelection:false,selections:{},dbPath:this.dbPath,viewName:"",title:"PickList",prompt:"Please make your selection(s) and click &lt;OK&gt;.",column:0,width:(p.multipleSelection&&!p.useCheckboxSelection)?700:600,height:400,constrainHeader:true,shadow:true,minWidth:500,minHeight:400,showActionbar:false,showSearch:true,useCheckboxSelection:false,viewConfig:{},category:null,emptyText:"Select a category...",showCategoryComboBox:false,categoryComboBoxCount:-1};Ext.apply(a,p);switch(a.type){case"custom":a.viewUrl=a.viewUrl||a.dbPath+a.viewName;break;case"names":a.viewUrl=(p.viewName&&p.viewName!=="")?a.dbPath+a.viewName:this.sess.addressBooks[0].webFilePath+"($PeopleGroupsFlat)";a.title=(p.title)?a.title:"Select Name";a.column=(p.column)?a.column:1;break;default:a.viewUrl=a.viewUrl||a.dbPath+a.viewName}c=function(){var q=false,r;if(a.selections.isXType&&a.selections.isXType("treepanel",true)){r=e()}else{r=d()}if(a.callback){q=a.callback}a.dialog.close();if(q){q(r)}else{return r}};l=function(){var q=false;if(a.callback){q=a.callback}a.dialog.close();if(q){q(null)}else{return null}};d=function(){var u,s=a.choices.getDocuments(),q=[],t,r;for(r=0;r<s.length;r++){u=(typeof a.column==="string")?a.column:s[r].fields.keys[a.column];t=s[r].data[u];q.push(t)}return q};e=function(){var u=a.selections,r=u.getRootNode(),s=r.childNodes,q=[],v,t;for(t=0;t<s.length;t++){v=s[t].text;q.push(v)}return q};a.choices=new Extnd.UIView(Ext.apply({region:"center",singleSelect:!a.multipleSelection,selModelConfig:(a.multipleSelection&&a.useCheckboxSelection)?{type:"checkbox",singSelect:false}:{},id:"xnd-picklist-view",xtype:"xnd-uiview",header:false,viewUrl:a.viewUrl,category:a.category,showCategoryComboBox:a.showCategoryComboBox,categoryComboBoxCount:a.categoryComboBoxCount,showActionbar:a.showActionbar,showSearch:a.showSearch},a.viewConfig));if(a.type==="names"){o=[];Ext.each(this.sess.addressBooks,function(s,r,q){o.push(s.filePath)});h=new Ext.FormPanel({id:"xnd-picklist-prompt",region:"north",frame:true,height:70,labelWidth:150,bodyStyle:{padding:5},items:[{xtype:"combo",fieldLabel:"Choose address book",value:this.sess.addressBooks[0].title,store:o,anchor:"95%"},{xtype:"xnd-picklist-typeahead",view:a.choices,fieldLabel:"Find names starting with",anchor:"95%"}]})}k=function(){var s=a.selections,r=s.getSelectionModel(),q=r.getSelectedNodes();if(q.length>0){q[0].remove()}};g=function(){var t=a.selections,q=t.getRootNode(),r=q.childNodes,s;for(s=r.length-1;s>=0;s--){r[s].remove()}};k=function(q,r){if(q.parentNode){q.remove()}};n=function(){var v,t,r,s,q,u;if(!a.multipleSelection){c();return false}if(a.multipleSelection&&!a.useCheckboxSelection){s=a.choices.getDocuments();if(s.length>0){for(q=0;q<s.length;q++){v=(typeof a.column==="string")?a.column:s[q].fields.keys[a.column];t=s[q].data[v];r=new Ext.tree.TreeNode({text:t});a.selections.root.appendChild(r)}a.choices.getSelectionModel().clearSelections()}u=false}else{c();u=false}return u};a.choices.on("beforeopendocument",n,this);if(a.multipleSelection&&!a.useCheckboxSelection){b=((a.height-140)/2)-40;a.selections=new Ext.tree.TreePanel({region:"center",layout:"fit",id:"selections",root:new Ext.tree.TreeNode({text:"Names:",draggable:false,id:"selections-root",expanded:true}),rootVisible:(a.type==="names")?true:false,selModel:new Ext.tree.MultiSelectionModel()});a.selections.on("dblclick",k,this);m={region:"west",width:100,frame:true,border:false,bodyBorder:false,bodyStyle:{paddingTop:b},hideBorders:false,items:[{xtype:"button",minWidth:85,text:"Add &rsaquo;",handler:n,scope:this},{xtype:"button",minWidth:85,text:"&lsaquo; Remove",handler:k},{xtype:"button",minWidth:85,text:"&laquo; Remove All",handler:g}]};i={region:"east",layout:"border",width:(a.width/2),items:[m,a.selections]}}if(!a.dialog){a.dialog=new Ext.Window({id:"xnd-picklist",layout:"border",modal:true,width:a.width,height:a.height,constrainHeader:a.constrainHeader,shadow:a.shadow,minWidth:a.minWidth,minHeight:a.minHeight,title:a.title,items:[(a.type==="names")?h:{region:"north",height:47,xtype:"box",bodyStyle:"padding : 4px;",html:a.prompt,id:"xnd-picklist-prompt"},a.choices,i],buttons:[{text:"OK",handler:Ext.bind(c,this)},{text:"Cancel",handler:Ext.bind(l,this)}]})}a.dialog.show()},prompt:function(b){var a,c={};if(typeof arguments[0]==="string"){c.type=arguments[0];c.title=arguments[1];c.prompt=arguments[2];c.callback=arguments[3]||false}else{c=b}if(c.type){c.type=c.type.toLowerCase()}else{c.type="ok"}switch(c.type){case"ok":Ext.MessageBox.alert(c.title,c.prompt,c.callback);break;default:Ext.MessageBox.alert("type '"+c.type+"', not yet supported")}},currentDocument:function(){return Ext.nd.currentUIDocument}});Ext.define("Extnd.data.overrides.XmlReader",{override:"Ext.data.reader.Xml",extractData:function(a){var b=this.record;if(!b){Ext.Error.raise("Record is a required parameter")}if(b!==a.nodeName){a=Ext.DomQuery.select("> "+b,a)}else{a=[a]}return this.callSuper([a])},createFieldAccessExpression:function(f,d,c){var e=this.namespace,b,a;b=f.mapping||((e?e+"|":"")+f.name);if(typeof b==="function"){a=d+".mapping("+c+", this)"}else{a='me.getNodeValue(Ext.DomQuery.selectNode("> '+b+'", '+c+"))"}return a}});Ext.define("Extnd.app.Application",{extend:Ext.app.Application,onBeforeLaunch:function(){var b=this,a;a=Extnd.app.Application.superclass.onBeforeLaunch;Extnd.extndDbUrl=b.extndDbUrl=b.extndDbUrl||b.extndUrl;Extnd.extndUrl=b.extndUrl||b.extndDbUrl;Extnd.extjsUrl=b.extjsUrl||b.extndUrl.replace("extnd","extjs");b.getSession({success:a,failure:a,scope:b})},login:function(){console.log("TODO login")},logout:function(){console.log("TODO logout")},getSession:function(a){var b=this;Ext.create("Extnd.Session",{extndUrl:b.extndUrl,dbPath:b.dbPath,success:b.onGetSessionSuccess,failure:b.onGetSessionFailure,config:a,scope:b})},onGetSessionSuccess:function(e,a,d){var c=this,b=d.options.config;c.session=e;Ext.callback(b.success,b.scope,arguments)},onGetSessionFailure:function(a){console.log("failed")}});Ext.define("Extnd.data.OutlineModel",{extend:Ext.data.Model,alternateClassName:["Ext.nd.data.OutlineModel","Ext.nd.data.OutlineEntry"],fields:[{name:"id",mapping:"@position"},{name:"text",mapping:"@title"},{name:"leaf",mapping:"@expandable",convert:function(a,c){var b;if(Ext.isBoolean(a)){b=a}else{if(c.get("id")==="root"||(a==="true"||a==="false")){b=false}else{b=true}}return b}},{name:"expanded",mapping:"@expandable",convert:function(a,c){var b;if(Ext.isBoolean(a)){b=a}else{if(c.get("id")==="root"||a==="true"){b=true}else{b=false}}return b}},{name:"url",mapping:"@url"},{name:"hrefTarget",mapping:"@framesetname"},{name:"type",mapping:"@type"}]});Ext.define("Extnd.data.OutlineXmlReader",{extend:Ext.data.reader.Xml,alias:"reader.xnd-outlinexml",alternateClassName:["Ext.nd.data.OutlineXmlReader"],readRecords:function(m){var j=this,c=Ext.DomQuery,a=[],d="outlinedata",f=c.select(j.record,m),h=f.length,e,l,b,g,k;for(e=0;e<h;e++){l=f[e];b=c.selectValue("@expandable",l,"");if(b!==""){Ext.get(l).appendChild(document.createElement(d))}g=c.selectValue("@position",l);a[g]=l;if(g.indexOf(".")>0){k=g.substring(0,g.lastIndexOf("."));c.selectNode(d,a[k]).appendChild(l)}}return j.callParent([m])}});Ext.define("Extnd.data.OutlineStore",{extend:Ext.data.TreeStore,model:"Extnd.data.OutlineModel",alternateClassName:["Ext.nd.data.OutlineStore"],constructor:function(a){var b=this;if(!a.outlineUrl){a.outlineUrl=a.dbPath+a.outlineName+"?ReadEntries"}else{a.outlineUrl=(a.outlineUrl.indexOf("?")!==-1)?a.outlineUrl:a.outlineUrl+"?ReadEntries"}a=Ext.apply({proxy:{type:"ajax",url:a.outlineUrl,reader:{type:"xnd-outlinexml",root:"outlinedata",record:"outlineentry"}}},a);b.callParent([a])}});Ext.define("Extnd.tree.Panel",{extend:Ext.tree.Panel,alias:["widget.xnd-uioutline","widget.xnd-treepanel","widget.xnd-tree"],alternateClassName:["Ext.nd.UIOutline","Extnd.UIOutline","Ext.nd.tree.Panel","Ext.nd.TreePanel"],rootVisible:false,useEntryTitleAsTargetTitle:true,constructor:function(a){a=this.cleanUpConfig(a);this.callParent([a])},cleanUpConfig:function(a){if(a.outlineName&&a.dbPath){a.outlineUrl=a.dbPath+a.outlineName}else{if(a.outlineName&&!a.dbPath){a.dbPath=Extnd.session.currentDatabase?Extnd.session.currentDatabase.webFilePath:null;if(!a.dbPath){a.dbPath=location.pathname.split(/\.nsf/i)[0];a.dbPath=a.dbPath||a.dbPath+".nsf/"}a.outlineUrl=a.dbPath+a.outlineName}else{if(a.outlineUrl){var b=a.outlineUrl.lastIndexOf("/")+1;a.dbPath=a.outlineUrl.substring(0,b);a.outlineName=a.outlineUrl.substring(b)}}}return a},initComponent:function(){var b=this,a=b.store;if(Ext.isString(a)){a=b.store=Ext.StoreMgr.lookup(a)}else{if(!a||(Ext.isObject(a)&&!a.isStore)){a=b.store=Ext.create("Extnd.data.OutlineStore",Ext.apply({outlineUrl:b.outlineUrl,dbPath:b.dbPath,outlineName:b.outlineName,root:b.root,folderSort:b.folderSort},a))}}b.callParent(arguments);b.addEvents("readentries","beforeopenentry","openentry","beforeaddtofolder","addfoldersuccess","addfolderfailure");b.on("itemclick",b.openEntry,b)},openEntry:function(h,k,a,j,q){var t=this,g=k.get("url"),c=k.get("type"),v=k.get("id"),n=k.get("hrefTarget"),x=t.id+"-"+v,w=(t.useEntryTitleAsTargetTitle)?k.get("text"):null,l,u,s,p,b,f,i,o,m,d,r;if(this.fireEvent("beforeopenentry",this,k)!==false){if(c==="2"||c==="20"){u=this.viewTarget||this.target;s=this.viewTargetDefaults||this.targetDefaults}else{u=this.target;s=this.targetDefaults}if(u){u=(u.getXType)?u:Ext.getCmp(u);u=(u&&u.getXType)?u:Ext.get(u)}l=Ext.getCmp(x);if(!l){if(c==="2"||c==="20"){c=1;i=(g.indexOf("?")>0)?g.split("?")[0]:g.split("!")[0];if(!u){window.open(i+"?OpenView")}else{o=Ext.apply(Ext.apply({xtype:"xnd-uiview",id:x,layout:"fit",title:w,viewUrl:i,closable:true,target:u},this.viewDefaults),s);if(u.getXType&&u.add){f=u.getXType();switch(f){case"grid":case"xnd-uiview":d=Ext.state.Manager.get(u.id);if(d){Ext.state.Manager.clear(u.id)}Ext.apply(o,{id:u.id,closable:false});if(u.ownerCt){p=u.ownerCt;m=p.items.indexOf(u);p.remove(u,true);b=p.insert(m,o)}else{b=u.add(o)}break;case"tabpanel":b=u.add(o);u.setActiveTab(b);break;default:b=u.add(o);r=u.getLayout();if(r.setActiveItem){r.setActiveItem(b)}break}}else{Ext.apply(o,{id:x});b=new Ext.nd.UIView(Ext.apply(o,{renderTo:u}))}}}else{if(g!==""){c=2;if(!u||n==="_top"){window.open(g)}else{if(u.getXType&&u.add){Extnd.util.Iframe.add({target:u,url:g,id:x,title:w,closable:true,useDocumentWindowTitle:false,targetDefaults:s})}}}}}else{if(l.show){l.show()}}this.fireEvent("openentry",this,k,c,b)}}});Ext.define("Extnd.container.Viewport",{extend:Ext.container.Viewport,alias:["widget.xnd-viewport","widget.xnd-dominoui"],alternateClassName:["Extnd.Viewport","Ext.nd.DominoUI"],layout:"border",initComponent:function(){var a=this;Ext.apply(a,{items:a.getItemsCfg()});a.callParent(arguments)},viewOpeningTitle:"Opening...",getItemsCfg:function(){var b,a;b=Ext.apply({id:"xnd-outline-panel",xtype:"xnd-uioutline",region:"west",title:"current Db Title",collapsible:true,split:true,width:200,minSize:150,maxSize:400,target:"xnd-center-panel",viewTarget:"xnd-grid-panel"},this.uiOutline);a={region:"center",id:"xnd-center-panel",xtype:"tabpanel",target:"xnd-center-panel",defaults:{target:"xnd-center-panel",border:true},enableTabScroll:true,activeTab:0,items:[Ext.apply({id:"xnd-grid-panel",layout:"fit",xtype:"xnd-uiview",target:"xnd-center-panel",closable:false},this.uiView)]};return[b,a]},loadLink:function(){var c=window.location.href,b,f,d,e,a;if(c.indexOf("?")>0||c.indexOf("!")>0){b=(c.indexOf("?")>0)?c.split("?")[1]:c.split("!")[1];f=Ext.urlDecode(b);d=f.link;e=d;if(d){a=(d.indexOf("?")>0)?c.split("?")[0]:d;Extnd.util.addIFrame({target:this.tabPanel,uiView:this.view,url:d,id:a,title:"Opening...",useIFrameTitle:true})}}}});Ext.define("Extnd.util.DominoActionbar",{alternateClassName:"Ext.nd.util.DominoActionbar",actionbar:false,actionbarHr:false,constructor:function(){var r=false,p=false,o=false,n=false,l=document.forms[0],a=Ext.DomQuery,k=l.childNodes,m=k.length,j,h,f,e,b,d,g;for(e=0;e<m;e++){j=k[e];if(j.nodeType===1){if(!r){if(j.tagName==="TABLE"){h=j;b=a.select("tr",h);if(b.length!==1){break}else{r=true;p=true;continue}}else{if((j.tagName==="INPUT"&&a.selectValue("@type",j,"")==="hidden")||j.tagName==="LABEL"){continue}else{break}}}else{if(j.tagName==="HR"){f=j;o=true}break}}if(r&&p&&o){break}}if(r&&p&&o){d=a.select("td",h);g=a.select("a",h);if(d.length===g.length){n=true;this.actionbar=h;this.actionbarHr=f}}},getActionbar:function(){return this.actionbar},getActionbarHr:function(){return this.actionbarHr},hide:function(){if(this.actionbar){Ext.get(this.actionbar).setStyle("display","none");Ext.get(this.actionbarHr).setStyle("display","none")}},remove:function(){if(this.actionbar){Ext.get(this.actionbar).remove();Ext.get(this.actionbarHr).remove()}}});Ext.define("Extnd.form.PickListField",{extend:Ext.form.field.Trigger,alias:"widget.xnd-picklist",alternateClassName:"Ext.nd.form.PickListField",type:"custom",viewName:"",viewConfig:null,multipleSelection:false,useCheckboxSelection:false,allowNew:false,triggerCls:"xnd-form-picklist-trigger",width:100,pickListWidth:600,column:0,defaultAutoCreate:{tag:"input",type:"text",autocomplete:"off"},category:undefined,showCategoryComboBox:false,categoryComboBoxCount:-1,initComponent:function(){if(this.type==="names"){this.trigger1Class="xnd-form-names-trigger"}this.callParent(arguments)},applyToMarkup:function(c){var a,b,d;if(c.tagName==="SELECT"){a=Ext.get(c);b=a.dom.name;a.dom.name=Ext.id();d=Ext.DomHelper.insertBefore(a,Ext.apply(this.defaultAutoCreate,{name:b}));Ext.removeNode(c);this.callParent([d])}else{this.callParent([c])}},onDestroy:function(){if(this.window){this.window.destroy()}if(this.wrap){this.wrap.remove()}Ext.nd.form.PickListField.superclass.onDestroy.call(this)},onTrigger1Click:function(){var a=new Extnd.UIWorkspace();a.pickList({type:this.type,width:this.pickListWidth,multipleSelection:this.multipleSelection,useCheckboxSelection:this.useCheckboxSelection,allowNew:this.allowNew,dbPath:this.dbPath,viewName:this.viewName,viewUrl:this.viewUrl,viewConfig:this.viewConfig,column:this.column,category:this.category,showCategoryComboBox:this.showCategoryComboBox,categoryComboBoxCount:this.categoryComboBoxCount,callback:Ext.bind(this.processReturnValues,this)})},processReturnValues:function(a){if(a!==null){this.setValue(a.join("; "))}}});Ext.define("Extnd.form.field.Time",{extend:Ext.form.field.Time,alias:"widget.xnd-timefield",alternateClassName:["Extnd.form.TimeField","Ext.nd.form.TimeField"],increment:60,selectOnFocus:true,triggerCls:"xnd-form-time-trigger"});Ext.define("Extnd.form.Panel",{extend:Ext.form.Panel,alias:["widget.xnd-uidocument","widget.xnd-form","widget.xnd-page"],alternateClassName:["Extnd.UIDocument","Ext.nd.UIDocument","Extnd.Form","Ext.nd.Form","Extnd.Page","Ext.nd.Page"],showActionbar:true,createActionsFrom:"document",convertFields:true,applyDominoKeywordRefresh:true,defaultFieldWidth:120,documentLoadingWindowTitle:"Opening",documentUntitledWindowTitle:"Untitled",useDocumentWindowTitle:true,documentWindowTitleMaxLength:16,refreshMessage:"Refreshing document...",initComponent:function(){Ext.override(Ext.Component,{applyToMarkup:function(k){var j=Ext.get(k);this.allowDomMove=false;this.setValue(j.dom.value);this.render(j.dom.parentNode,null,true);Ext.removeNode(j.dom)}});var f=this,g=Extnd.session,h=g.currentDatabase,e=Extnd.currentUIDocument||{},c=document.forms,a,i,b,d;Ext.apply(f,e);f.document=f.document||{};f.uidoc=e;f.dbPath=h.webFilePath;if(f.convertFields){f.layout="form";f.contentEl=f.getDominoForm();f.items={xtype:"label",hidden:true}}f.dateTimeFormats=Extnd.dateTimeFormats;if(f.formName===undefined){if(c.length===0||c[0].name.substring(1)===""||c[0].name.substring(1)==="DominoForm"){a=location.href.toLowerCase();i=location.search.toLowerCase();b=a.indexOf(f.dbPath.toLowerCase())+f.dbPath.length;d=(i!=="")?a.indexOf(i):a.length;f.formName=location.href.substring(b,d)}else{f.formName=document.forms[0].name.substring(1)}}f.formUrl=f.formUrl||f.dbPath+f.formName;f.setupToolbars();f.addEvents("beforeclose","beforemodechange","beforeopen","beforesave","open");f.callParent(arguments);f.setPostUrl();if(Ext.isFunction(_doClick)){_doClick=Ext.bind(f._doClick,f)}},_doClick:function(a,g,b,c){var d=this.getDominoForm(),f,e;if(d.dom.onsubmit){f=d.onsubmit();if(typeof f==="boolean"&&f===false){return false}}e=document._domino_target;if(g.href!=null){if(g.target!=null){e=g.target}}else{if(b!=null){e=b}}d.dom.target=e;if(d.dom.__Click){d.dom.__Click.value=a}if(c){d.dom.action+=c.replace("#","#xnd-goto")}d.dom.submit();return false},createFormzzz:function(){delete this.initialConfig.listeners;if(!this.items){this.items={xtype:"label",hidden:true}}return new Ext.form.BasicForm(document.forms[0],this.initialConfig)},render:function(){if(arguments.length===0){Ext.create("Ext.Viewport",{layout:"fit",items:this})}else{this.callParent(arguments)}},onRenderzz:function(b,a){this.callParent(arguments);this.setupButtons()},afterRender:function(){if(this.convertFields){this.callParent(arguments);Ext.Ajax.request({method:"GET",disableCaching:true,success:this.doConvertFieldsCB,failure:this.doConvertFieldsCB,args:arguments,scope:this,url:Extnd.extndUrl+"DXLExporter?OpenAgent&db="+this.dbPath+"&type=form&name="+this.formName})}else{this.callParent(arguments);this.fireEvent("open",this)}},getDominoForm:function(){var a=this;if(!a.dominoForm){a.dominoForm=Ext.get(document.forms[0])}return a.dominoForm},edit:function(a){var b=this;if(b.fireEvent("beforemodechange",b)!==false){b.onEdit(a)}},onEdit:function(c){var d=this,e=d.getUIView(),b=e?e.viewName:"0",a=d.document.universalID;location.href=d.dbPath+b+"/"+a+"?EditDocument"},save:function(a){var b=this;if(b.fireEvent("beforesave",b)!==false){b.onSave(a)}},onSave:function(b){var c=this.getForm(),d,a={};b=(b===undefined)?{closeOnSave:false}:(typeof b==="boolean")?{closeOnSave:b}:b;d=c.findField("%%ModDate");if(d){d.disable()}if(b.success){a.success=b.success;delete b.success}if(b.failure){a.failure=b.failure;delete b.failure}if(b.scope){a.scope=b.scope;delete b.scope}c.submit(Ext.apply({method:"POST",success:this.onSaveCallback,failure:this.onSaveCallback,cb:a,scope:this},b))},onSaveCallback:function(f,g){var e=this,d=g.options,c=d.cb,b=g.result,h=b.msg,a=b.unid||b.universalID;if(a){e.setUniversalID(a)}if(b.success){if(c.success){c.success.apply(c.scope||e,arguments)}}else{if(c.failure){c.failure.apply(c.scope||e,arguments)}}},close:function(a){if(this.fireEvent("beforeclose",this)!==false){this.onClose(a)}},onClose:function(a){var d=false,f=this.getTarget(),c,e,b;if(f){switch(f.getXType()){case"window":if(f.closeAction==="close"){f.close();d=true}else{f.hide();d=true}break;case"tabpanel":f.remove(f.getActiveTab());d=true;break;default:if(f.remove){c=this.getIframeOwnerCt();if(c){f.remove(this.iframeOwnerCt);d=true}else{d=false}}else{d=false}break}}else{if(this.editMode){e=this.getUIView();b=e?e.viewName:"0";a=a||this.document.universalID;if(a){location.href=this.dbPath+b+"/"+a+"?OpenDocument"}else{location.href=this.dbPath}}else{d=false}}return d},setPostUrl:function(){var c=this,f=c.getForm(),e,d,b,a;if(!f.url){e=c.getDominoForm().dom.action;if(e===""){d=c.getUIView();b=d?d.viewName:"0";a=c.document.universalID;f.url=c.dbPath+b+"/"+a+"?SaveDocument"}else{f.url=e}}},setUniversalID:function(a){var c=this,e=c.getForm(),d=c.getUIView(),b=d?d.viewName:"0";a=a||c.document.universalID;e.url=c.dbPath+b+"/"+a+"?SaveDocument";c.document.universalID=a;c.isNewDoc=false},setupToolbars:function(){var a;if(this.tbar){a="xnd-doc-tbar-"+Ext.id();if(Ext.isArray(this.tbar)){this.tbar=new Extnd.Actionbar({id:a,noteName:(this.showActionbar)?this.formName:"",uiView:this.getUIView(),uiDocument:this.getUIDocument(),target:this.getTarget()||null,createActionsFrom:this.createActionsFrom,items:this.tbar})}else{this.tbar.id=a;this.tbar.target=this.getTarget()||null;this.tbar.uiDocument=this.getUIDocument();this.tbar.uiView=this.getUIView()}this.dominoActionbar=new Extnd.util.DominoActionbar();this.dominoActionbar.hide()}else{if(this.showActionbar){this.tbar=new Extnd.Actionbar({id:a,noteType:"form",noteName:this.formName,uiView:this.getUIView(),uiDocument:this.getUIDocument(),target:this.getTarget()||null,createActionsFrom:this.createActionsFrom,renderTo:this.toolbarRenderTo||null})}}},setupButtons:function(){if(this.buttons){if(this.fbar){this.fbar.target=this.getTarget()||null;this.fbar.uiDocument=this.getUIDocument();this.fbar.uiView=this.getUIView()}}},doConvertFieldsCB:function(b,c){this.fieldDefinitions=new Ext.util.MixedCollection(false,this.getFieldDefinitionKey);this.fieldDefinitions.addAll(Ext.DomQuery.select("field",b.responseXML));var a=Ext.DomQuery.select("noteinfo",b.responseXML);this.noteinfo={unid:Ext.DomQuery.selectValue("@unid",a),noteid:Ext.DomQuery.selectValue("@noteid",a),sequence:Ext.DomQuery.selectValue("@sequence",a)};this.doConvertFields();this.fireEvent("open",this)},doConvertFields:function(){var f,d,g=this.getDominoForm().dom.elements,e=new Ext.util.MixedCollection(),a=g.length,c,b;for(c=0;c<a;c++){d=g[c].id||Ext.id();e.add(d,g[c])}Ext.each(e.items,function(j,h,i){if(!this.convertFromClassName(j,false)){this.convertFromTagName(j)}},this);b=Ext.DomQuery.select("*[class*=xnd-]");Ext.each(b,function(j,h,i){this.convertFromClassName(j,true)},this)},getFieldDefinition:function(a){var b=null;if(a.name){b=this.fieldDefinitions?this.fieldDefinitions.get(a.name):null}return b},convertFromTagName:function(c){var d=this,e,g,f,a,b;switch(c.tagName){case"BUTTON":break;case"SELECT":e=this.getFieldDefinition(c);if(e){g=(Ext.DomQuery.selectValue("@allowmultivalues",e)==="true")?true:false;f=(Ext.DomQuery.selectValue("keywords/@allownew",e)==="true")?true:false;a=Ext.DomQuery.selectValue("@choicesdialog",e);if(a==="view"){this.convertToPickList(c,{type:"custom",viewName:Ext.DomQuery.selectValue("@view",e),column:Ext.DomQuery.selectNumber("@viewcolumn",e),multipleSelection:g,allowNew:f})}else{this.convertSelectToComboBox(c,true)}}else{this.convertSelectToComboBox(c,true)}break;case"TEXTAREA":this.convertToTextAreaField(c);break;case"FIELDSET":this.convertToFieldSet(c);break;case"INPUT":b=c.getAttribute("type");switch(b){case"hidden":this.convertToHiddenField(c);break;case"checkbox":this.convertToCheckbox(c);break;case"radio":this.convertToRadio(c);break;case"file":this.convertToFileUpload(c);break;case"button":break;default:this.convertFromDominoFieldType(c)}break;default:this.convertToTextField(c);break}},convertFromDominoFieldType:function(b){var c=this,d=c.getFieldDefinition(b),a;if(d){a=Ext.DomQuery.selectValue("@type",d);switch(a){case"password":case"text":c.convertToTextField(b);break;case"datetime":c.convertToDateTimeField(b);break;case"number":c.convertToNumberField(b);break;case"names":c.convertNamesField(b);break;case"keyword":c.convertKeywordField(b);break}}else{c.convertToTextField(b)}},getFieldDefinitionKey:function(a){return Ext.DomQuery.selectValue("@name",a)},convertFromClassName:function(d,e){var b=d.className.split(" "),h,g=b.length,a,f=false;for(h=0;h<g;h++){a=b[h];switch(a){case"xnd-combobox":if(e){this.convertSelectToComboBox(d,true)}f=true;break;case"xnd-combobox-appendable":if(e){this.convertSelectToComboBox(d,false)}f=true;break;case"xnd-date":if(e){this.convertToDateField(d)}f=true;break;case"xnd-number":if(e){this.convertToNumberField(d)}f=true;break;case"xnd-time":if(e){this.convertToTimeField(d)}f=true;break;case"xnd-htmleditor":if(e){this.convertToHtmlEditor(d)}f=true;break;case"xnd-picklist-names":if(e){this.convertToNamePicker(d)}f=true;break;case"xnd-ignore":f=true;break;default:break}}return f},convertToHiddenField:function(a){var b=new Ext.form.field.Hidden({itemId:(a.id||a.name),name:(a.name||a.id)});b.applyToMarkup(a);this.add(b)},convertToTextField:function(a){var b=new Ext.form.TextField({name:(a.name||a.id),itemId:(a.id||a.name),width:this.getFieldWidth(a)});b.applyToMarkup(a);this.add(b)},convertToFieldSet:function(b){var a=new Ext.form.FieldSet({itemId:(b.id||b.name),name:(b.name||b.id),autoHeight:true,autoWidth:true});a.applyToMarkup(b)},convertNamesField:function(b){var c=this.getFieldDefinition(b),e,d,a;if(c){e=(Ext.DomQuery.selectValue("@allowmultivalues",c)==="true")?true:false;d=(Ext.DomQuery.selectValue("keywords/@allownew",c)==="true")?true:false;a=Ext.DomQuery.selectValue("@choicesdialog",c,false);if(a){switch(a){case"addressbook":this.convertToNamePicker(b,{multipleSelection:e,allowNew:d});break;case"acl":this.convertToACLDialog(b,{multipleSelection:e,allowNew:d});break;case"view":this.convertToPickList(b,{type:"custom",viewName:Ext.DomQuery.selectValue("@view",c),column:Ext.DomQuery.selectNumber("@viewcolumn",c),multipleSelection:e,useCheckboxSelection:true,allowNew:d});break}}else{this.convertToTextField(b)}}},convertToNamePicker:function(c,b){b=b||{};var a=new Extnd.form.PickListField(Ext.apply({type:"names",itemId:(c.id||c.name),name:(c.name||c.id),width:this.getFieldWidth(c)},b));a.applyToMarkup(c);this.add(a)},convertToPickList:function(c,a){var b=new Extnd.form.PickListField(Ext.apply({itemId:(c.id||c.name),name:(c.name||c.id),width:this.getFieldWidth(c)},a));b.applyToMarkup(c);this.add(b)},convertToTextAreaField:function(b){var a=new Ext.form.TextArea({itemId:(b.id||b.name),name:(b.name||b.id),resizable:true});a.applyToMarkup(b);this.add(a)},convertToFileUpload:function(e){var k=Ext.DomHelper,j=e.attributes,d="",m="",l,b,h,g,i,c,f,a;if(Ext.ux.form.FileUploadField){e.id=e.id||Ext.id();if(j){l=j.getNamedItem("style");b=j.getNamedItem("class");d=l?l.value:"";m=b?b.value:""}h=e.name;g=e.id;i=Ext.get(e).findParentNode("p",true);if(i){c=i.innerHTML;k.insertBefore(i,{tag:"div",html:c});Ext.removeNode(i);e=Ext.getDom(g)}f=k.insertBefore(e,{tag:"div",id:Ext.id()},true);a=new Ext.ux.form.FileUploadField({id:g,name:h,renderTo:f.id,width:this.getFieldWidth(e)});e.name=Ext.id();Ext.removeNode(e);this.add(a)}else{this.convertToTextField(e)}},convertToHtmlEditor:function(d){Ext.QuickTips.init();var a=d.tagName.toLowerCase(),c,b;if(a==="div"){c=new Ext.form.HtmlEditor({itemId:(d.id||d.name),renderTo:d})}else{b=Ext.DomHelper.insertBefore(d,{tag:"div",style:{width:500}},true);b.dom.appendChild(d);Ext.get(d).setStyle({width:510});c=new Ext.form.HtmlEditor();c.applyToMarkup(d);c.on("beforepush",function(h,g){var j="[<div class='xnd-htmleditor-read'>",f="</div>]",i=j.length,e=g.length-f.length;if(g.indexOf(j)===0){g=g.substring(i,e)}h.getEditorBody().innerHTML=g;return false});c.on("beforesync",function(f,e){f.el.dom.value="[<div class='xnd-htmleditor-read'>"+e+"</div>]";return false})}this.add(c)},convertToNumberField:function(b){var a=new Ext.form.NumberField({width:this.getFieldWidth(b),name:(b.name||b.id),itemId:(b.id||b.name)});a.applyToMarkup(b);this.add(a)},convertToDateTimeField:function(b){var c=this.getFieldDefinition(b),a;if(c){a=Ext.DomQuery.selectValue("datetimeformat/@show",c);switch(a){case"date":this.convertToDateField(b);break;case"time":this.convertToTimeField(b);break}}},convertToDateField:function(a){var b=new Ext.form.DateField({itemId:(a.id||a.name),name:(a.name||a.id),selectOnFocus:true,format:this.dateTimeFormats.dateFormat,width:this.getFieldWidth(a)});b.applyToMarkup(a);this.add(b)},convertToTimeField:function(b){var a=new Extnd.form.field.Time({width:this.getFieldWidth(b),itemId:(b.id||b.name),name:(b.name||b.id)});a.applyToMarkup(b);this.add(a)},convertToCheckbox:function(d){var e=this.getFieldDefinition(d),b=this.getDominoGeneratedBoxLabel(d,true),a=Ext.DomQuery.selectValue("keywords/@columns"),c=new Ext.form.Checkbox({boxLabel:b,itemId:(d.id||d.name),name:(d.name||d.id)});c.applyToMarkup(d);this.add(c)},convertToRadio:function(c){var e=this.getFieldDefinition(c),b=this.getDominoGeneratedBoxLabel(c,true),a=Ext.DomQuery.selectValue("keywords/@columns"),d;d=new Ext.form.Radio({itemId:(c.id||c.name),name:(c.name||c.id),boxLabel:b});d.applyToMarkup(c);this.add(d)},getDominoGeneratedBoxLabel:function(e,d){var b="",c=e.nextSibling,a;if(c&&c.nodeType===3){b=c.nodeValue;if(d){if(Extnd.session&&Extnd.session.notesBuildVersion<=359){a=Ext.get(e).next()}else{a=Ext.get(e).up("label").next()}if(a!==null&&a.dom.nodeName==="BR"){a.remove()}c.parentNode.removeChild(c)}}return b},convertKeywordField:function(c){var d=this.getFieldDefinition(c),g,f,a,b,e;if(d){g=(Ext.DomQuery.selectValue("@allowmultivalues",d)==="true")?true:false;f=(Ext.DomQuery.selectValue("keywords/@allownew",d)==="true")?true:false;a=Ext.DomQuery.selectValue("@choicesdialog",d);if(a==="addressbook"){this.convertToNamePicker(c,{multipleSelection:g,allowNew:f});return}if(a==="acl"){this.convertToACLDialog(c,{multipleSelection:g,allowNew:f});return}if(a==="view"){this.convertToPickList(c,{type:"custom",viewName:Ext.DomQuery.selectValue("@view",d),column:Ext.DomQuery.selectNumber("@viewcolumn",d),multipleSelection:g,allowNew:f});return}b=Ext.DomQuery.select("keywords/textlist",d);e=Ext.DomQuery.selectValue("keywords/formula",d,null);if(b.length>0){this.convertToSelectFromTextlist(c,b);return}if(e){this.convertToSelectFromFormula(c,e);return}return}},convertToSelectFromTextlist:function(c,b){var a,d;a=new Ext.data.Store({data:b,fields:["text","value"],reader:new Ext.data.reader.Xml({record:"text"},[{name:"value",convert:function(e,f){return Ext.DomQuery.selectValue("",f)}}])});d=new Ext.form.ComboBox({itemId:(c.id||c.name),name:(c.name||c.id),displayField:"value",store:a,typeAhead:true,mode:"local",triggerAction:"all",selectOnFocus:true,width:this.getFieldWidth(c)});d.applyToMarkup(c);this.add(d)},convertToACLDialog:function(a){},convertToSelectFromFormula:function(d,e){var c=Extnd.extndUrl+"Evaluate?OpenAgent",b,a;b=new Ext.data.Store({proxy:new Ext.data.HttpProxy({method:"POST",url:c}),reader:new Ext.data.ArrayReader({},[{name:"value"}]),baseParams:{formula:e,db:this.dbPath,unid:(this.document&&this.document.universalID)?this.document.universalID:"",form:this.formName,outputformat:"json",convertresulttoarray:true}});b.on("load",function(g,f,h){var i=g,j=f,k=h});a=new Ext.form.ComboBox({itemId:(d.id||d.name),name:(d.name||d.id),store:b,typeAhead:true,triggerAction:"all",displayField:"value",valueField:"value",forceSelection:true,resizable:true,width:this.getFieldWidth(d)});a.applyToMarkup(d);this.add(a)},convertToMultiSelect:function(b,a){},convertToAllowMultiValueSelect:function(b,a){},convertSelectToComboBox:function(el,forceSelection){var cbContainer,s,d,opts,selectedValue,value,i,len,o,store,attr,style,cls,oStyle,oCls,cb,extcallback,onChange,sOnChange;if(el.parentNode.tagName==="FONT"){cbContainer=Ext.DomHelper.insertBefore(el.parentNode,{tag:"div"},true);cbContainer.dom.appendChild(el)}s=Ext.getDom(el);d=[];opts=s.options;selectedValue="";for(i=0,len=opts.length;i<len;i++){o=opts[i];value=(o.hasAttribute?o.hasAttribute("value"):o.getAttribute("value")!==null)?o.value:o.text;value=(value===""&&o.text!=="")?o.text:value;if(o.selected){selectedValue=value}d.push([value,o.text])}store=new Ext.data.ArrayStore({id:0,fields:["value","text"],data:d,autoDestroy:true});attr=el.attributes;style="";cls="";if(attr){oStyle=attr.getNamedItem("style");oCls=attr.getNamedItem("class");style=oStyle?oStyle.value:"";cls=oCls?oCls.value:""}cb=new Ext.form.ComboBox({transform:el,itemId:(el.id||el.name),name:(el.name||el.id),hiddenName:el.name,store:store,mode:"local",value:selectedValue,valueField:"value",displayField:"text",typeAhead:true,triggerAction:"all",lazyRender:false,forceSelection:forceSelection,resizable:true,style:style,cls:cls,width:this.getFieldWidth(el)});if(this.applyDominoKeywordRefresh){attr=el.attributes;if(attr){onChange=attr.onchange;if(onChange&&onChange.nodeValue!==null){sOnChange=onChange.nodeValue;extcallback=function(){if(sOnChange.indexOf("$Refresh")>0){Ext.MessageBox.wait(this.refreshMessage)}eval(sOnChange)};cb.on("select",extcallback,this)}}}this.add(cb)},getFieldWidth:function(c){var e=Ext.get(c),a=e.getStyle("width"),b,d;if(a.indexOf("%",0)>0){d=a}else{if(parseFloat(a)===0){d=parseFloat(a)}else{b=e.getComputedWidth();d=b===0?this.defaultFieldWidth:b}}return d},fieldGetText:function(b){var a=this.getForm().findField(b);return a?a.getValue():""},fieldSetText:function(b,c){var a=this.getForm().findField(b);if(a){try{a.setValue(c)}catch(d){}}},fieldAppendText:function(b,c){var a=this.getForm().findField(b);if(a){try{a.setValue(a.getValue()+c)}catch(d){}}},fieldClear:function(b){var a=this.getForm().findField(b);if(a){try{a.setValue("")}catch(c){}}},fieldContains:function(c,a){var b=this.getForm().findField(c),d=false,g;if(b){try{g=b.getValue().indexOf(a);d=(g===-1)?false:true}catch(f){}}return d},getTarget:function(){var a;if(this.target){a=this.target}else{if(window&&window.target){this.target=window.target;a=this.target}else{if(this.ownerCt&&this.ownerCt.getXType&&this.ownerCt.getXType()==="tabpanel"){this.target=this.ownerCt.id;a=this.target}else{a=null}}}return a},getIframeOwnerCt:function(){var a;if(this.iframeOwnerCt){a=this.iframeOwnerCt}else{if(window&&window.ownerCt){this.iframeOwnerCt=window.ownerCt;a=this.iframeOwnerCt}else{a=null}}return a},getUIView:function(){var a;if(this.uiView&&this.uiView!==null){a=this.uiView}else{if(window&&window.uiView){this.uiView=window.uiView;a=this.uiView}else{a=null}}return a},getUIDocument:function(){return this}});Ext.define("Extnd.toolbar.mixins.DominoObjectGetters",{getUIView:function(){var a=this;if(!a.uiView){if(a.ownerCt&&a.ownerCt.getXType()==="xnd-uiview"){a.uiView=a.ownerCt}else{a.uiView=null}}return a.uiView},getUIDocument:function(){var a=this;if(!a.uiDocument){if(a.ownerCt&&a.ownerCt.getXType()==="xnd-uidocument"){a.uiDocument=a.ownerCt}else{a.uiDocument=null}}return a.uiDocument}});