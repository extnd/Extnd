<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Extnd-form-PickListField'>/**
</span> * Provides a PickList field which opens an {@link Ext.Window} with a view of documents to choose from.
 */
Ext.define('Extnd.form.PickListField', {

    extend  : 'Ext.form.field.Trigger',
    alias   : 'widget.xnd-picklist',

    alternateClassName: 'Ext.nd.form.PickListField',

    requires: [
        'Extnd.UIWorkspace'
    ],

<span id='Extnd-form-PickListField-cfg-type'>    /**
</span>     * @cfg {String}
     * The picklist type (custom or names)
     */
    type : &quot;custom&quot;,

<span id='Extnd-form-PickListField-cfg-viewName'>    /**
</span>     * @cfg {String}
     * The name of the view to load the 'choice' list.
     */
    viewName : &quot;&quot;,

<span id='Extnd-form-PickListField-cfg-viewConfig'>    /**
</span>     * @cfg {Object}
     * Any additional view configs that you want applied to the UIView.
     */
    viewConfig : null,

<span id='Extnd-form-PickListField-cfg-multipleSelection'>    /**
</span>     * @cfg {Boolean}
     * Whether or not to allow multiple documents to be selected.
     */
    multipleSelection : false,

<span id='Extnd-form-PickListField-cfg-useCheckboxSelection'>    /**
</span>     * @cfg {Boolean}
     * Whether or not to display checkboxes in the first column.
     */
    useCheckboxSelection : false,

<span id='Extnd-form-PickListField-cfg-allowNew'>    /**
</span>     * @cfg {Boolean}
     * Whether or not to allow new values to be entered.
     */
    allowNew : false,

<span id='Extnd-form-PickListField-cfg-triggerCls'>    /**
</span>     * @cfg {String}
     * @inheritdoc
     */
    triggerCls : 'xnd-form-picklist-trigger',

<span id='Extnd-form-PickListField-cfg-width'>    /**
</span>     * @cfg {Number}
     * The width of the input field (defaults to 100).
     */
    width : 100,

<span id='Extnd-form-PickListField-cfg-pickListWidth'>    /**
</span>     * @cfg {Number}
     * The width of the PickList dialog window (defaults to 300).
     */
    pickListWidth : 600,

<span id='Extnd-form-PickListField-cfg-column'>    /**
</span>     * @cfg {Number}
     * The column whose values you want returned from the selected choices (defaults to 0).
     */
    column : 0,

<span id='Extnd-form-PickListField-cfg-autoCreate'>    /**
</span>     * @cfg {String/Object} autoCreate
     * A DomHelper element spec, or true for a default element spec (defaults to
     * {tag: &quot;input&quot;, type: &quot;text&quot;, size: &quot;10&quot;, autocomplete: &quot;off&quot;})
     */

<span id='Extnd-form-PickListField-property-defaultAutoCreate'>    // private
</span>    defaultAutoCreate : {tag: &quot;input&quot;, type: &quot;text&quot;, autocomplete: &quot;off&quot;},
<span id='Extnd-form-PickListField-property-category'>    category : undefined,
</span><span id='Extnd-form-PickListField-property-showCategoryComboBox'>    showCategoryComboBox : false,
</span><span id='Extnd-form-PickListField-property-categoryComboBoxCount'>    categoryComboBoxCount: -1,
</span>

<span id='Extnd-form-PickListField-method-initComponent'>    initComponent : function () {
</span>        if (this.type === 'names') {
            this.trigger1Class = 'xnd-form-names-trigger';
        }
        this.callParent(arguments);
    },

<span id='Extnd-form-PickListField-method-applyToMarkup'>    applyToMarkup : function (el) {
</span>        var oldEl,
            oldName,
            newEl;

        // applyToMarkup only works if the element is an input element
        // so since domino will sometimes send an empty select or even
        // a textarea field for a picklist, we have to create an input
        // element in its place and delete the old element

        if (el.tagName === &quot;SELECT&quot;) {
            oldEl = Ext.get(el);
            oldName = oldEl.dom.name;
            oldEl.dom.name = Ext.id(); // wipe out the name in case somewhere else they have a reference
            // create our new element and insert before the old one
            newEl = Ext.DomHelper.insertBefore(oldEl, Ext.apply(this.defaultAutoCreate, {name : oldName}));
            Ext.removeNode(el); // remove the old element completely from the dom
            this.callParent([newEl]);
        } else {
            this.callParent([el]);
        }


    },

<span id='Extnd-form-PickListField-method-onDestroy'>    // private
</span>    onDestroy : function () {
        if (this.window) {
            this.window.destroy();
        }
        if (this.wrap) {
            this.wrap.remove();
        }
        Ext.nd.form.PickListField.superclass.onDestroy.call(this);
    },

<span id='Extnd-form-PickListField-method-onTriggerClick'>    /**
</span>     * @method onTriggerClick
     * @hide
     */
<span id='Extnd-form-PickListField-method-onTrigger1Click'>    // private
</span>    // Implements the default empty TriggerField.onTriggerClick function to display the PickList
    onTrigger1Click : function () {
        var ws = new Extnd.UIWorkspace();
        ws.pickList({
            type                    : this.type,
            width                   : this.pickListWidth,
            multipleSelection       : this.multipleSelection,
            useCheckboxSelection    : this.useCheckboxSelection,
            allowNew                : this.allowNew,
            dbPath                  : this.dbPath,
            viewName                : this.viewName,
            viewUrl                 : this.viewUrl,
            viewConfig              : this.viewConfig,
            column                  : this.column,
            category                : this.category,
            showCategoryComboBox    : this.showCategoryComboBox,
            categoryComboBoxCount   : this.categoryComboBoxCount,
            callback                : Ext.bind(this.processReturnValues, this)
        });
    },

<span id='Extnd-form-PickListField-method-processReturnValues'>    // private
</span>    processReturnValues : function (arValues) {
        if (arValues !== null) {
            this.setValue(arValues.join('; '));
        }
    }

});
</pre>
</body>
</html>
