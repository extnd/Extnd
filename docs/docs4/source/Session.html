<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Extnd-Session'>/**
</span> * Represents the environment of the current script, providing access to environment variables, Address Books, information
 * about the current user, and information about the current Domino Server platform and release number.
 */
Ext.define('Extnd.Session', {

<span id='Extnd-Session-property-addressBooks'>    /**
</span>     * @property {Extnd.Database[]} addressBooks
     * The Domino Directories and Personal Address Books, including directory catalogs, known to the current session.
     */

<span id='Extnd-Session-property-commonUserName'>    /**
</span>     * @property {String} commonUserName
     * The common name portion of the current user's name.
     */

<span id='Extnd-Session-property-currentDatabase'>    /**
</span>     * @property {Extnd.Database} currentDatabase
     * The database first accessed when this session was initialized.  If no database was specified, then this will be the Extnd database.
     */

<span id='Extnd-Session-property-effectiveUserName'>    /**
</span>     * @property {String} effectiveUserName
     * The user name that is in effect for the current program.
     */

<span id='Extnd-Session-property-httpURL'>    /**
</span>     * @property {String} httpURL
     * The Domino URL of a session when HTTP protocols are in effect.
     */

<span id='Extnd-Session-property-notesBuildVersion'>    /**
</span>     * @property {Float} notesBuildVersion
     * The Domino server's release number.
     */

<span id='Extnd-Session-property-notesVersion'>    /**
</span>     * @property {String} notesVersion
     * The Domino server's release version.  Example: &quot;Release 7.0.1|January 17, 2006&quot;
     */

<span id='Extnd-Session-property-platform'>    /**
</span>     * @property {String} platform
     * The name of the platform the server is running on.
     */

<span id='Extnd-Session-property-serverName'>    /**
</span>     * @property {String} serverName
     * The full name of the server that the session is running on.
     */

<span id='Extnd-Session-property-userGroupNameList'>    /**
</span>     * @property {Extnd.NotesName[]} userGroupNameList
     * The groups to which the current user belongs.
     * example: {&quot;abbreviated&quot; : &quot;ExtNDAdmin&quot;, &quot;addr821&quot; : &quot;&quot;, &quot;common&quot; : &quot;ExtNDAdmin&quot;}
     */

<span id='Extnd-Session-property-userName'>    /**
</span>     * @property {String} userName
     * The current user's name.
     * example: &quot;CN=Rich Waters/O=ExtND&quot;
     */

<span id='Extnd-Session-property-userNameList'>    /**
</span>     * @property {String[]} userNameList
     * The name of the user that created the session, and the alternate name if it exists.
     */

<span id='Extnd-Session-property-userRoles'>    /**
</span>     * @property {String[]} userRoles
     * user roles
     */

<span id='Extnd-Session-method-constructor'>    /**
</span>     * Creates a new Extnd.Session instance by making an Ajax call to the Extnd database to get the Session
     * properties for the current user and optionally the current database information referred to in the #dbPath config.
     */
    constructor: function (config) {
        var me = this;

        Ext.apply(me, config);

        Ext.Ajax.request({
            method          : 'GET',
            disableCaching  : true,
            success         : me.onGetSessionSuccess,
            failure         : me.onGetSessionFailure,
            scope           : me,
            options         : config,
            url             : me.extndUrl + 'Session.json?OpenAgent&amp;db=' + me.dbPath || ''
        });


    },

<span id='Extnd-Session-method-onGetSessionSuccess'>    /**
</span>     * @private
     */
    onGetSessionSuccess: function (response, request) {
        var sessionData = Ext.decode(response.responseText),
            options     = request.options;

        // apply sessionData to this
        Ext.apply(this, sessionData);

        // now call the callback and pass the session (this) to it
        Ext.callback(options.success, options.scope, [this, response, request]);
    },

<span id='Extnd-Session-method-onGetSessionFailure'>    /**
</span>     * @private
     */
    onGetSessionFailure: function (response) {
        console.log('failed');
    },

<span id='Extnd-Session-method-evaluate'>    /**
</span>     * Evaluates a Domino formula.
     */
    evaluate: function (formula, doc) {
        console.log('TODO implement evaluate code');
    },

<span id='Extnd-Session-method-getDatabase'>    /**
</span>     * Creates an Extnd.Database object that represents the database located at the server and file name you specify,
     * and opens the database, if possible.
     */
    getDatabase: function (server, dbFile, createOnFail) {
        console.log('TODO implement getDatabase code');
    },

<span id='Extnd-Session-method-getDbDirectory'>    /**
</span>     * Creates a New Extnd.DbDirectory object using the name of the server you wnat to access.
     */
    getDbDirectory: function (server) {
        console.log('TODO implement getDbDirectory');
    },

<span id='Extnd-Session-method-getDirectory'>    /**
</span>     * Creates a New Extnd.Directory object using the name of the server you wnat to access.
     */
    getDirectory: function (server) {
        console.log('TODO implement getDirectory');
    }

});
</pre>
</body>
</html>
